<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MotionEditor Editing Video Motion via Content-Aware Diffusion — happy8825 - Seohyun Lee Blog</title>
    <meta name="description" content="Intro
Background &amp; Intro
현재의 video edit diffusion 모델은 주로 주인공의 속성, 배경 편집, 스타일 편집 등 텍스처 편집에 초점을 맞추고 있음. 동영상의 가장 독특한 특징인 움직임 정보는 거의 다루어지지 않고 있는데 그렇다면 reference">
    <link rel="stylesheet" href="../../styles.css">
    <style>
        body { 
            background: #0d0f17; 
            color: #fff; 
            font-family: 'Inter', sans-serif; 
            line-height: 1.6; 
            margin: 0; 
            padding: 2rem;
            max-width: 900px;
            margin: 0 auto;
        }
        .post-header {
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding-bottom: 2rem;
            margin-bottom: 2rem;
        }
        .post-meta {
            color: #888;
            margin-bottom: 1rem;
        }
        .post-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .post-content {
            font-size: 1.1rem;
            line-height: 1.8;
        }
        .post-content img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 1rem 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        .post-content p {
            margin-bottom: 1rem;
        }
        .post-content h1, .post-content h2, .post-content h3 {
            color: #667eea;
            margin-top: 2rem;
            margin-bottom: 1rem;
        }
        .post-content blockquote {
            border-left: 4px solid #667eea;
            padding-left: 1rem;
            margin: 1.5rem 0;
            color: #ccc;
            font-style: italic;
        }
        .post-content code {
            background: rgba(255, 255, 255, 0.1);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }
        .post-content pre {
            background: rgba(0, 0, 0, 0.3);
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
        }
        .back-link {
            display: inline-block;
            margin-bottom: 2rem;
            color: #667eea;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        .back-link:hover {
            background: rgba(102, 126, 234, 0.2);
        }
    </style>
</head>
<body>
    <a href="../../blog.html" class="back-link">← Back to Blog</a>
    
    <div class="post-header">
        <div class="post-meta">
            <span>📅 2024-07-21</span>
            <span> | 🏷️ Computer Vision Paper Review</span>
            <span> | 🔗 <a href="https://happy8825.tistory.com/24" target="_blank">Original Post</a></span>
            <span> | 📊 3 images</span>
        </div>
        <h1 class="post-title">MotionEditor Editing Video Motion via Content-Aware Diffusion — happy8825</h1>
        
    </div>
    
    <div class="post-content">
        <h3 data-ke-size="size23" id="Intro-1"><a href="#Intro-1">Intro</a></h3>
<h4 data-ke-size="size20"><u>Background &amp; Intro</u></h4>
<p data-ke-size="size18">현재의 video edit diffusion 모델은 주로 주인공의 속성, 배경 편집, 스타일 편집 등 텍스처 편집에 초점을 맞추고 있음. 동영상의 가장 독특한 특징인 움직임 정보는 거의 다루어지지 않고 있는데 그렇다면<b> reference 영상에 맞춰 원본 동영상의 움직임을 조작</b>할 수 있을까? 라는 질문에서 시작된 연구이다.</p>
<p data-ke-size="size18">이 논문에서는<b> reference 영상과 프롬프트를 기반으로 source video의 주인공의 움직임을 reference video와 일치시키면서 원래의 외모를 유지하는 것을 목표</b>로 한다.</p>
<p data-ke-size="size18">기존 연구들은 주로 reference skeleton을 기반으로 정지 이미지를 애니메이션화하거나 포즈에 맞춘 동영상을 생성하는 데 초점을 맞췄다. 하지만 이러한 접근 방식은 원하는 외모를 유지하지 못하거나, 복잡한 배경과 카메라 움직임을 보존하는 데 한계가 있었음. MotionEditor는 이러한 한계를 극복하고, 동영상의 움직임을 직접 수정하면서도 다른 비디오 정보를 유지하는 새로운 방법을 제안한다.</p>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li><u><b>Content aware motion editor</b></u>: MotionEditor는 ControlNet에 콘텐츠 인식 모션 어댑터를 추가하여 원본 텍스처를 보존하면서 일관된 motion edit이 가능하게 한다. 이&nbsp; adapter는 content aware block이랑 temporal block으로 구성되며, cross attention을 통해 source frame의 feature를 통합하여 motion control의 품질을 향상시켜준다</li>
<li><u><b>Skeleton align algorithm</b></u>: source와 reference skeleton 간의 크기와 위치 차이를 보정하기 위해 skeleton align algorithm을 개발했음</li>
<li><b><u>Attention inject mechanism</u> : </b>&nbsp;reconstruction branch와 editing branch, 두 branch를 기반으로, editing branch가 reconstruction branch에서서 키와 값을 받와서, 원본 동영상의 배경과 주인공의 외모를 유지하면서 참조 동영상의 움직임을 적용할 수 있음. 이 과정에서 segmentation maks를 사용해 foreground랑 background 정보를 분리해줌. 이렇게 함으로써 최종 편집된 동영상의 품질을 높이고, 원래의 시각적 일관성을 유지할 수 있음.</li>
</ul>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style5">
<h3 style="color: #000000; text-align: start;" data-ke-size="size23" id="Related%20Work-1"><a href="#Related%20Work-1">Related Work</a></h3>
<h4 data-ke-size="size20"><u> Diffusion for Image Editing</u></h4>
<p data-ke-size="size18">이미지 생성모델은 디퓨전의 발달로 GAN시대와는 상상도 못할정도로 빠르게 발전중인데,&nbsp; 대표적으로 SDEdit이라는 모델, 역방향 변환을 통해 더 정밀한 이미지 편집을 가능한 모델이 있구,</p>
<p data-ke-size="size18">Prompt-to-Prompt와 Plug-and-Play등 일관되지 않은 노이즈 문제를 해결하여 더 일관된 이미지를 생성하는 기술이나 UniTune과 Imagic등&nbsp; personalize finetuning에 집중한 모델도 나왔음.</p>
<p data-ke-size="size18">Controllable 디퓨전 모델 등도 발달이 되왔는데, ControlNet을 도입하여 Stable Diffusion이 텍스트-이미지 generation할때 여러 control을 줄 수 있게 하는 등. 전체적으로, 이러한 접근법들은 불규칙한 노이즈 처리, finetuning, reverse editing등을 통해 모델을 발전시켰음</p>
<h4 style="color: #000000; text-align: start;" data-ke-size="size20"><u>Diffusion for Video Editing and Generation</u></h4>
<p data-ke-size="size18">video generation은 특히 temporal consistency를 요구하는 더 복잡한 작업인데, 보통 대부분의 방법들은 기존 image editing 모델에 temporal modeling 모듈을 하나 더 달아서 해결했음. 그치만 이렇게 하면, low-level 에서 editing 만 가능하고, 모션과 같은 복잡한 정보를 편집할 수 없음</p>
<p data-ke-size="size18">최근에는 pose 기반 video generation이 연구되고 있는데, Follow-Your-Pose나 ControlVideo등, 근데 이런 방법들은 video generation에 초점을 맞추고 있어 source video의 주인공이나 배경에 왜곡이 생길 수 있음.&nbsp;</p>
<p data-ke-size="size18">이런 모델과 달리 <b>MotionEditor는 Source video를 보존하면서 motion edit을 하는걸 목표로 함.</b></p>
<h4 style="color: #000000; text-align: start;" data-ke-size="size20"><u>Human Motion Transfer</u></h4>
<p data-ke-size="size18">동영상의 동작을 target 이미지로 transfer시켜서 애니메이션화하는것이 목표. LWG는 3D pose projection을 통해 motion transfer를 하지만, internal motion은 잘 모델링하지 못함. FOMM은 boundary key point를 통해 motion transfer를 하고, MRAA는 regional feature를 활용하지만, 복잡한 장면에서는 성능이 제한적임. 이런 한계점 해결을 위해 <b>MotionEditor은 복잡한 배경과 동작에 대해서도 일관된 detail을 생성할 수 있는 diffusion을 활용해 video editing을 함.</b></p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style5">
<h3 data-ke-size="size23" id="Preliminaries-1"><a href="#Preliminaries-1">Preliminaries</a></h3>
<p data-ke-size="size16">는 계속 봐왔던 DDPM, DDIM 샘플링, 이미지를 인코더를 통해 latent sapce 에서 디퓨전시키는 LDM에 대한 소개가 되어있습니당. 바로 method로 넘어갈게요</p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style5">
<h3 style="color: #000000; text-align: start;" data-ke-size="size23" id="Method-1"><a href="#Method-1">Method</a></h3>
<p></p><figure class="imageblock alignCenter" data-ke-mobilestyle="widthOrigin" data-origin-width="1098" data-origin-height="572" style="margin-left: 50%; transform: translateX(-50%); width: 1098px; max-width: 1098px;"><span data-url="https://blog.kakaocdn.net/dna/th2Ga/btsIHDmQDu2/AAAAAAAAAAAAAAAAAAAAAPoqaehDmGtzJNevhwA8QU4QexR5JGl4N1JFwY6xuc4R/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=aF5ZLvMOPCkbp1x1wJl0GblEspE%3D" data-phocus="https://blog.kakaocdn.net/dna/th2Ga/btsIHDmQDu2/AAAAAAAAAAAAAAAAAAAAAPoqaehDmGtzJNevhwA8QU4QexR5JGl4N1JFwY6xuc4R/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=aF5ZLvMOPCkbp1x1wJl0GblEspE%3D"><img src="https://blog.kakaocdn.net/dna/th2Ga/btsIHDmQDu2/AAAAAAAAAAAAAAAAAAAAAPoqaehDmGtzJNevhwA8QU4QexR5JGl4N1JFwY6xuc4R/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=aF5ZLvMOPCkbp1x1wJl0GblEspE%3D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2Fth2Ga%2FbtsIHDmQDu2%2FAAAAAAAAAAAAAAAAAAAAAPoqaehDmGtzJNevhwA8QU4QexR5JGl4N1JFwY6xuc4R%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3DaF5ZLvMOPCkbp1x1wJl0GblEspE%253D" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';" loading="lazy" width="1098" height="572" data-origin-width="1098" data-origin-height="572" data-phocus-index="0"></span></figure>
<p></p>
<h4 data-ke-size="size20"><u>Overall architecture</u></h4>
<p data-ke-size="size18">MotionEditor는 주로 LDM이랑 Controlnet을 기반으로함.</p>
<p data-ke-size="size18"><i>- Latent Diffusion Model (LDM)</i></p>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li><b>LDM </b>인코더-디코더의 UNET 구조로, 인코더는 입력 이미지를 점차 압축하여 특징을 추출하고, 디코더는 이 특징을 사용해 이미지를 재구성한다</li>
<li><b>Spatial Transformer</b>는 2 dimension으로, 이미지의 공간적 특징을 변환하는 역할을 함</li>
</ul>
<p data-ke-size="size18"><i>-ControlNet</i></p>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li><b>ControlNet</b>은 포즈 정보를 입력받아 이미지 생성을 제어하는 모델로, LDM과 결합되어 포즈 조건에 따라 이미지를 생성할 수 있음</li>
</ul>
<p data-ke-size="size16"><b>여기서 변환되거나 추가된거는</b></p>
<p data-ke-size="size18"><i>- 3D Transformer&nbsp;</i></p>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li><b>3D Transformer</b>: video 의 consistency를 위해 LDM의 U-Net에 self-attention 레이어를 추가하여 2D에서 3D로 확장한다.</li>
<li><b>Consistent-Sparse Attention</b>: 기존의 spatial self-attention를 대체하기 위해 제안된 메커니즘으로, temporal spatial 모두 고려햔 attention 매커니즘으로, 더 효율적이게 consistency를 보장할 수 있음.</li>
</ul>
<p data-ke-size="size18"><i>-Motion Adapter</i></p>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li><b>Content-Aware Cross-Attention Block</b>: U-Net에서 추출한 feature이랑 ControlNet에서 나온 conditional pose 정보를 사용해 corss attention을함. 이를 통해 모션 정보를 정확하게 조정한다</li>
<li><b>Temporal Attention Block : </b>시간적 일관성을 유지하기 위한 블록</li>
</ul>
<p data-ke-size="size18"><i>-One-Shot Training</i></p>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>source video에 대해&nbsp; motion adpter이랑 temporal attention block의 weight를 학습한다. 이를 통해 sourc video 의 원본 텍스처 특징을 보존하면서 모션을 적절히 조정할 수 있음</li>
</ul>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style2">
<p data-ke-size="size18"><i>-Inference Process</i></p>
<p data-ke-size="size18">&nbsp;</p>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li><b>Skeleton Alignment (</b>소스 비디오와 레퍼런스 비디오 간의 스켈레톤 차이를 줄여 motion info를 정확히 반영):
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>Source skeleton이랑 reference skeleton의 크기와 위치를 비교해서 차이 계산</li>
<li>스켈레톤의 크기를 맞추고 위치를 조정하여 정렬된 target skeleton 생성</li>
</ul>
</li>
<li><b>DDIM Inversion</b>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>비디오의 픽셀 값을 이용해 초기 latent noise 생성</li>
<li>alligned 된 target skeleton을 기반으로 latent space에서 노이즈를 샘플링해서 시작점을 설정함</li>
</ul>
</li>
<li><b>Motion Editing</b>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>레퍼런스 비디오의 모션 정보를 소스 비디오에 적용하면서 원본의 appearance 를 유지하게 하는 과정으로
<ol style="list-style-type: decimal;" data-ke-list-type="decimal">
<li><b>Editing Branch</b>: allinged target skeleton에서 추출한 특징을 입력으로 받아 모션 정보를 소스 비디오에 적용한다</li>
<li><b>Reconstruction Branch:</b> 소스 비디오의 원본 외형 정보와 배경 정보를 유지하며, reconstruction branch로 Key와 밸류Value 를 주입함</li>
<li><b>High-Fidelity Attention Injection</b>: reconstruction branch에서 추출한 세부 정보를 editing branch로 주입하여, 모션 변경 과정에서 원본 비디오의 appearance랑 배경 정보를 최대한 보존한다</li>
</ol>
</li>
</ul>
</li>
<li><b>Denoising</b></li>
</ul>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style5">
<p data-ke-size="size16">그럼 하니씩 자세히보자</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">&nbsp;</p>


<h4 data-ke-size="size20"><u>MotionEditor의 Content-Aware Motion Adapter</u></h4>
<p data-ke-size="size18">&nbsp;</p>
<p data-ke-size="size18">ControlNet은 condition에 기반해서 직접적인 controllable 생성을 가능하게 하지만, motion editing 에는 한계가 있음. 모션 신호는 ControlNet에 의해 주입되며, 소스 모션과 충돌할 수 있다는 점인데 이러한 문제를 해결하기 위해 Temporal Content-Aware Motion Adapter를 제안했다</p>
<p data-ke-size="size18">Motion Adapter는 ControlNet의 출력 feature를 입력으로 받아 동작한다. 이 어댑터는 Global Modeling Path와 Local Modeling Path로 구성이 됨. 빨간 부분이 global modeling path, 초록 부분이 local modeling path</p>
<p></p><figure class="imageblock alignCenter" data-ke-mobilestyle="widthOrigin" data-origin-width="356" data-origin-height="152" style="margin-left: 50%; transform: translateX(-50%); width: 356px; max-width: 356px;"><span data-url="https://blog.kakaocdn.net/dna/crXf4A/btsIHyTKECR/AAAAAAAAAAAAAAAAAAAAAOzBSu_W3bJWmEKpn6sz8oImIlytFQ59jRMnY5X1sYus/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=AnNf%2FY29a%2FOfx4hxwRzqGFjmNHs%3D" data-phocus="https://blog.kakaocdn.net/dna/crXf4A/btsIHyTKECR/AAAAAAAAAAAAAAAAAAAAAOzBSu_W3bJWmEKpn6sz8oImIlytFQ59jRMnY5X1sYus/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=AnNf%2FY29a%2FOfx4hxwRzqGFjmNHs%3D"><img src="https://blog.kakaocdn.net/dna/crXf4A/btsIHyTKECR/AAAAAAAAAAAAAAAAAAAAAOzBSu_W3bJWmEKpn6sz8oImIlytFQ59jRMnY5X1sYus/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=AnNf%2FY29a%2FOfx4hxwRzqGFjmNHs%3D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2FcrXf4A%2FbtsIHyTKECR%2FAAAAAAAAAAAAAAAAAAAAAOzBSu_W3bJWmEKpn6sz8oImIlytFQ59jRMnY5X1sYus%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3DAnNf%252FY29a%252FOfx4hxwRzqGFjmNHs%253D" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';" loading="lazy" width="356" height="152" data-origin-width="356" data-origin-height="152" data-phocus-index="1"></span></figure>
<p></p>
<p data-ke-size="size18"><u><b><i> Global Modeling Path</i></b></u></p>
<p data-ke-size="size18"><b>Content-Aware Cross-Attention Block</b>:</p>
<p data-ke-size="size18">Pose feature(<i>mi</i>)랑 U-Net에서 생성된 해당 프레임의 latent feature(<i>zi</i>)을 입력으로 받아 cross attention이 된다. 이 블록은 controlnet에서 나 pose feature를 쿼리(<i>Q</i>)로, unet에서 나온 프레임의 latent feature를 키(<i>K</i>)와 밸류(<i>V</i>)로 사용하여 연관된 모션 단서를 강조한다.&nbsp;</p>
<p style="text-align: center;" data-ke-size="size18">Q=WQc⁢mi,K=WKc⁢zi,V=WVc⁢zi</p>
<p data-ke-size="size18">즉, 크로스 어텐션은 pose feature이랑 frame 의 latent feature를 결합해서 비디오의 latent space에서 모션을 조작할 수 있게 한다</p>
<p data-ke-size="size18"><b>Temporal Attention Block:</b></p>
<p data-ke-size="size18">시간적 일관성을 유지하면서 모션을 조작한다. 이 블록은 비디오 프레임 간의 시간적 연속성을 유지하기 위해 설계되었음.</p>
<p data-ke-size="size18"><u><b><i>Local Modeling Path</i></b></u></p>
<p data-ke-size="size18"><b>Temporal Convolution Block</b>:</p>
<p data-ke-size="size18">local 모션 feature를 잘 포착하기 위해 두 개의 temporal convolution block을 사용한다.&nbsp;</p>
<p data-ke-size="size18">Motion Adapter는 ControlNet에서 출력된 포즈 feature를 사용하여 U-Net의 latent feature과 결합함으로써 모션을 조작한다. Cross attention block은 포즈 특징을 쿼리로 사용하고,frame latent feature를 키와 밸류로 사용한다.</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">&nbsp;</p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style5">


<h4 data-ke-size="size20"><u>MotionEditor의 High-Fidelity Attention Injection</u></h4>
<p></p><figure class="imageblock alignCenter" data-ke-mobilestyle="widthOrigin" data-origin-width="568" data-origin-height="414" style="margin-left: 50%; transform: translateX(-50%); width: 568px; max-width: 568px;"><span data-url="https://blog.kakaocdn.net/dna/bekHXV/btsIIhqvGQT/AAAAAAAAAAAAAAAAAAAAAJCP_j20967cXoYKUkHUeC6Rv2kcsK9EhVZ2CCQi6Vdy/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=TIpR0Ej%2Bq9XSKCYu0s7U7Xmkf%2F0%3D" data-phocus="https://blog.kakaocdn.net/dna/bekHXV/btsIIhqvGQT/AAAAAAAAAAAAAAAAAAAAAJCP_j20967cXoYKUkHUeC6Rv2kcsK9EhVZ2CCQi6Vdy/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=TIpR0Ej%2Bq9XSKCYu0s7U7Xmkf%2F0%3D"><img src="https://blog.kakaocdn.net/dna/bekHXV/btsIIhqvGQT/AAAAAAAAAAAAAAAAAAAAAJCP_j20967cXoYKUkHUeC6Rv2kcsK9EhVZ2CCQi6Vdy/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=TIpR0Ej%2Bq9XSKCYu0s7U7Xmkf%2F0%3D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2FbekHXV%2FbtsIIhqvGQT%2FAAAAAAAAAAAAAAAAAAAAAJCP_j20967cXoYKUkHUeC6Rv2kcsK9EhVZ2CCQi6Vdy%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3DTIpR0Ej%252Bq9XSKCYu0s7U7Xmkf%252F0%253D" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';" loading="lazy" width="568" height="414" data-origin-width="568" data-origin-height="414" data-phocus-index="2"></span></figure>
<p></p>
<p data-ke-size="size16">MotionEditor의 모션 어댑터는 인체 포즈를 정확하게 캡처할 수 있지만, 주인공의 외형과 배경이 의도치 않게 변경될 수 있다. 이를 해결하기 위해 reconstruction branch에서 editing branch로의 <b>High-Fidelity Attention Injection</b>을 제안했다.&nbsp;</p>
<p data-ke-size="size16">기존의 attention fusion paradigms 방식에서는 foreground랑 background가 제대로 구분되지 못해서, 특히 motion edit에 있어서 context confusion이 생겼음. 이를 해결하기 위해 키와 밸류를 foreground랑 background로 분리한 다음, reconstruction path에서 editing path로 주입했음</p>
<p data-ke-size="size16">MotionEditor의 U-Net 내 각 어텐션 블록은 다음으로 되는데</p>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>Consistent-Sparse Attention (CS Attention)</li>
<li>Cross Attention</li>
<li>Temporal Attention</li>
</ul>
<p data-ke-size="size16">CS Attention은 원래 U-Net의 spatial attention을 대체한다. 이렇게하면 추가적인 computational 부담 없이 temporal modeling 이 가능함.&nbsp;</p>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li><b>쿼리(Query)</b>: 현재 프레임 (<i>zr_i</i>)에서 파생되는데, 현재 프레임의 정보를 기반으로 중요도를 계산하는데 사용</li>
<li><b>키(Key)와 밸류(Value)</b>: 이전 프레임 (<i>zr_{i-1}</i>)과 현재 프레임 (<i>zr_i</i>)에서 얻어진다(시간적 일관성 유지하기 위해 두 프레임의 정보가 같이 사용되는거)</li>
</ul>
<p style="text-align: center;" data-ke-size="size16"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="0" style="font-size: 116%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D444 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em; margin-left: 0.055em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D444 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.185em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mstyle><mjx-mspace style="width: 1em;"></mjx-mspace></mjx-mstyle><mjx-msup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em; margin-left: 0.052em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em; margin-left: 0.055em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D43E TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.181em;"></mjx-spacer><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.185em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mstyle><mjx-mspace style="width: 1em;"></mjx-mspace></mjx-mstyle><mjx-msup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em; margin-left: 0.059em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em; margin-left: 0.055em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.181em;"></mjx-spacer><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.185em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>Q</mi><mi>r</mi></msup><mo>=</mo><msup><mi>W</mi><mi>Q</mi></msup><msubsup><mi>z</mi><mi>i</mi><mi>r</mi></msubsup><mo>,</mo><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle><msup><mi>K</mi><mi>r</mi></msup><mo>=</mo><msup><mi>W</mi><mi>K</mi></msup><mo stretchy="false">[</mo><msubsup><mi>z</mi><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow><mi>r</mi></msubsup><mo>,</mo><msubsup><mi>z</mi><mi>i</mi><mi>r</mi></msubsup><mo stretchy="false">]</mo><mo>,</mo><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle><msup><mi>V</mi><mi>r</mi></msup><mo>=</mo><msup><mi>W</mi><mi>V</mi></msup><mo stretchy="false">[</mo><msubsup><mi>z</mi><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow><mi>r</mi></msubsup><mo>,</mo><msubsup><mi>z</mi><mi>i</mi><mi>r</mi></msubsup><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></p>
<p data-ke-size="size18"><b><u><i>Attention injection</i></u></b></p>
<p data-ke-size="size18"><i>1.&nbsp; foreground and background 분리</i></p>
<p data-ke-size="size18">마스크 <i>M</i>을 사용해서 키와 밸류를 foreground(<i>fg</i>)와 background(<i>bg</i>)로 분리한다</p>
<p style="text-align: center;" data-ke-size="size18"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="1" style="font-size: 115.9%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.273em; margin-left: -0.04em;"><mjx-mi class="mjx-i" size="s" style="margin-left: 0.13em;"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D454 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msubsup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em; margin-left: 0.052em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2299"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mstyle><mjx-mspace style="width: 1em;"></mjx-mspace></mjx-mstyle><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.273em; margin-left: -0.186em;"><mjx-mi class="mjx-i" size="s" style="margin-left: 0.347em;"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D454 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msubsup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em; margin-left: 0.059em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2299"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msubsup><mi>K</mi><mrow data-mjx-texclass="ORD"><mi>f</mi><mi>g</mi></mrow><mi>r</mi></msubsup><mo>=</mo><msup><mi>K</mi><mi>r</mi></msup><mo>⊙</mo><mi>M</mi><mo>,</mo><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle><msubsup><mi>V</mi><mrow data-mjx-texclass="ORD"><mi>f</mi><mi>g</mi></mrow><mi>r</mi></msubsup><mo>=</mo><msup><mi>V</mi><mi>r</mi></msup><mo>⊙</mo><mi>M</mi></math></mjx-assistive-mml></mjx-container> <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="2" style="font-size: 115.9%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.266em; margin-left: -0.04em;"><mjx-mi class="mjx-i" size="s" style="margin-left: 0.13em;"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D454 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msubsup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em; margin-left: 0.052em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2299"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mstyle><mjx-mspace style="width: 1em;"></mjx-mspace></mjx-mstyle><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.266em; margin-left: -0.186em;"><mjx-mi class="mjx-i" size="s" style="margin-left: 0.347em;"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D454 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msubsup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em; margin-left: 0.059em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2299"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msubsup><mi>K</mi><mrow data-mjx-texclass="ORD"><mi>b</mi><mi>g</mi></mrow><mi>r</mi></msubsup><mo>=</mo><msup><mi>K</mi><mi>r</mi></msup><mo>⊙</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>M</mi><mo stretchy="false">)</mo><mo>,</mo><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle><msubsup><mi>V</mi><mrow data-mjx-texclass="ORD"><mi>b</mi><mi>g</mi></mrow><mi>r</mi></msubsup><mo>=</mo><msup><mi>V</mi><mi>r</mi></msup><mo>⊙</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>M</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></p>
<p data-ke-size="size18"><i>2. CS Attention에서 주입</i></p>
<p data-ke-size="size18">Editing branch에서 CS Attention의 키와 밸류는 키 <i>K<sub>inj</sub></i>와 밸류 <i>V<sub>inj</sub></i>로 업데이트된다</p>
<p style="text-align: center;" data-ke-size="size18"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="3" style="font-size: 115.9%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em; margin-left: 0.052em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em; margin-left: 0.055em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D43E TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.181em;"></mjx-spacer><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.185em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em; margin-left: 0.055em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D43E TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.181em;"></mjx-spacer><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em; margin-left: 0.055em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D43E TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.185em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: -0.04em;"><mjx-mi class="mjx-i" size="s" style="margin-left: 0.13em;"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.34em;"></mjx-spacer><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: -0.04em;"><mjx-mi class="mjx-i" size="s" style="margin-left: 0.13em;"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.34em;"></mjx-spacer><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>K</mi><mi>e</mi></msup><mo>=</mo><msup><mi>W</mi><mi>K</mi></msup><mo stretchy="false">[</mo><msubsup><mi>z</mi><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow><mi>e</mi></msubsup><mo>,</mo><msubsup><mi>z</mi><mi>i</mi><mi>e</mi></msubsup><mo stretchy="false">]</mo><mo>=</mo><mo stretchy="false">[</mo><msup><mi>W</mi><mi>K</mi></msup><msubsup><mi>z</mi><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow><mi>e</mi></msubsup><mo>,</mo><msup><mi>W</mi><mi>K</mi></msup><msubsup><mi>z</mi><mi>i</mi><mi>e</mi></msubsup><mo stretchy="false">]</mo><mo>:=</mo><mo stretchy="false">[</mo><msubsup><mi>K</mi><mrow data-mjx-texclass="ORD"><mi>p</mi><mi>r</mi></mrow><mi>e</mi></msubsup><mo>,</mo><msubsup><mi>K</mi><mrow data-mjx-texclass="ORD"><mi>c</mi><mi>u</mi></mrow><mi>e</mi></msubsup><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></p>
<p style="text-align: center;" data-ke-size="size18"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="4" style="font-size: 115.9%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em; margin-left: 0.059em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em; margin-left: 0.055em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.181em;"></mjx-spacer><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.185em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em; margin-left: 0.055em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.181em;"></mjx-spacer><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em; margin-left: 0.055em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.185em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: -0.186em;"><mjx-mi class="mjx-i" size="s" style="margin-left: 0.347em;"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.34em;"></mjx-spacer><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: -0.186em;"><mjx-mi class="mjx-i" size="s" style="margin-left: 0.347em;"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.34em;"></mjx-spacer><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>V</mi><mi>e</mi></msup><mo>=</mo><msup><mi>W</mi><mi>V</mi></msup><mo stretchy="false">[</mo><msubsup><mi>z</mi><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow><mi>e</mi></msubsup><mo>,</mo><msubsup><mi>z</mi><mi>i</mi><mi>e</mi></msubsup><mo stretchy="false">]</mo><mo>=</mo><mo stretchy="false">[</mo><msup><mi>W</mi><mi>V</mi></msup><msubsup><mi>z</mi><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow><mi>e</mi></msubsup><mo>,</mo><msup><mi>W</mi><mi>V</mi></msup><msubsup><mi>z</mi><mi>i</mi><mi>e</mi></msubsup><mo stretchy="false">]</mo><mo>:=</mo><mo stretchy="false">[</mo><msubsup><mi>V</mi><mrow data-mjx-texclass="ORD"><mi>p</mi><mi>r</mi></mrow><mi>e</mi></msubsup><mo>,</mo><msubsup><mi>V</mi><mrow data-mjx-texclass="ORD"><mi>c</mi><mi>u</mi></mrow><mi>e</mi></msubsup><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></p>
<p data-ke-size="size18">insereted 키와 밸류:</p>
<p style="text-align: center;" data-ke-size="size18"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="5" style="font-size: 115.9%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.04em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.273em; margin-left: -0.04em;"><mjx-mi class="mjx-i" size="s" style="margin-left: 0.13em;"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D454 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.266em; margin-left: -0.04em;"><mjx-mi class="mjx-i" size="s" style="margin-left: 0.13em;"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D454 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: -0.04em;"><mjx-mi class="mjx-i" size="s" style="margin-left: 0.13em;"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.34em;"></mjx-spacer><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>K</mi><mrow data-mjx-texclass="ORD"><mi>i</mi><mi>n</mi><mi>j</mi></mrow></msub><mo>=</mo><mo stretchy="false">[</mo><msubsup><mi>K</mi><mrow data-mjx-texclass="ORD"><mi>f</mi><mi>g</mi></mrow><mi>r</mi></msubsup><mo>,</mo><msubsup><mi>K</mi><mrow data-mjx-texclass="ORD"><mi>b</mi><mi>g</mi></mrow><mi>r</mi></msubsup><mo>,</mo><msubsup><mi>K</mi><mrow data-mjx-texclass="ORD"><mi>c</mi><mi>u</mi></mrow><mi>e</mi></msubsup><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container> <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="6" style="font-size: 115.9%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.186em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.273em; margin-left: -0.186em;"><mjx-mi class="mjx-i" size="s" style="margin-left: 0.347em;"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D454 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.266em; margin-left: -0.186em;"><mjx-mi class="mjx-i" size="s" style="margin-left: 0.347em;"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D454 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: -0.186em;"><mjx-mi class="mjx-i" size="s" style="margin-left: 0.347em;"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.34em;"></mjx-spacer><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>V</mi><mrow data-mjx-texclass="ORD"><mi>i</mi><mi>n</mi><mi>j</mi></mrow></msub><mo>=</mo><mo stretchy="false">[</mo><msubsup><mi>V</mi><mrow data-mjx-texclass="ORD"><mi>f</mi><mi>g</mi></mrow><mi>r</mi></msubsup><mo>,</mo><msubsup><mi>V</mi><mrow data-mjx-texclass="ORD"><mi>b</mi><mi>g</mi></mrow><mi>r</mi></msubsup><mo>,</mo><msubsup><mi>V</mi><mrow data-mjx-texclass="ORD"><mi>c</mi><mi>u</mi></mrow><mi>e</mi></msubsup><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></p>
<p data-ke-size="size18"><i>3. Temporal Attention에서 insert</i></p>
<p data-ke-size="size18">Temporal Attention의 경우, CS Attention보다 주입이 간단한데, reconstruction branch의 <i>K^r</i>와 <i>V^r</i>를 edit branch로 직접 주입한다</p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style5">
<p data-ke-size="size18">Skeleton Signal Alignment</p>
<p data-ke-size="size18">source video랑 reference video 사이에&nbsp; 크기와 좌표의 차이등으로 인해,&nbsp; edit 성능에 악영향이 있을 수 있다. 이를 해결하기 위해 제안된 아이디어로, 이 알고리즘은 resizing 이랑 평행 이동이라는 두 단계를 포함한다. 알고리즘 순서대로 좀 정리해봤는데</p>
<p data-ke-size="size18">1. source/ reference 비디오 전처리</p>
<p data-ke-size="size18">source 비디오 <i>X<sub>sr</sub></i>와 레퍼런스 비디오 <i>X<sub>rf</sub></i>에서 다음을 추출함(pretrained 모델을 통해)</p>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>source 스켈레톤 <i>S<sub>sr</sub></i></li>
<li>source foreground 마스크 <i>M<sub>sr</sub></i></li>
<li>reference 스켈레톤 <i>S<sub>rf</sub></i></li>
<li>reference foreground 마스크 <i>M<sub>rf</sub></i></li>
</ul>
<p data-ke-size="size18">2. foreground의 edge detection</p>
<p data-ke-size="size18">foreground mask에 edge detection을 해서 foreground 의 직사각형 외곽선을 얻는다. 이를 통해 소스 비디오와 레퍼런스 비디오의 foreground영역을 직사각형으로 정의한다</p>
<p data-ke-size="size18">3. Resizing</p>
<p data-ke-size="size18">직사각형 외곽선의 면적을 기준으로 레퍼런스 스켈레톤 <i>S<sub>rf</sub></i>을 소스 비디오와 동일한 크기로 조정한다. 이를 통해 두 비디오의 주인공 크기를 일치시킴.</p>
<p data-ke-size="size18">4. 중심 좌표 계산</p>
<p data-ke-size="size18">각 마스크에서 전경 픽셀의 평균 좌표를 계산하여 주인공의 중심을 찾습니다. 이를 통해 소스 비디오와 레퍼런스 비디오 주인공의 중심 좌표를 얻는다</p>
<p data-ke-size="size18">5. offset vector 계산, 평행이동</p>
<p data-ke-size="size18">두 중심 좌표 간의 차이를 계산하여 오프셋 벡터를 구한다. 이 벡터를 사용하여 평행 이동을 위한 affine transformation 행렬을 생성한다, 이 행렬을 크기 조정된 레퍼런스 스켈레톤에 적용하여 최종 타겟 스켈레톤 <i>S<sub>tg</sub></i>을 생성한다</p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style2">
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">근데 개인적인 생각으로는 너무 상황에 따라 정확도가 많이 달라질거 같음. 이 알고리즘은,,</p>
<p data-ke-size="size16">foreground 마스크나 skeleton 추출이 정확하게 되지 않을 수 도 있고</p>
<p data-ke-size="size16">mask 가 복잡하거나 비대칭적인 형태인 경우에는 평균좌표가 실제 주인공의 중심과 다를 수 있고</p>
<p data-ke-size="size16">단순 affine 변환을 한다는데, source랑 reference 비디오의 주인공이 완전 다른 포즈르 하면? 과연 효과가 있을지도 의문이다</p>
<p data-ke-size="size16">&nbsp;</p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style5">
<p data-ke-size="size18">그리고 그냥 이 논문 뭔가 무슨말인진 알겠는데, 왜 이렇게 하는지 잘 인해가 안가는것들이 많았다.. ablation study부분 좀 더 읽어봐야겠다</p>
    </div>
    
    <div style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid rgba(255,255,255,0.1); text-align: center;">
        <a href="../../blog.html" class="back-link">← Back to Blog</a>
    </div>
</body>
</html>
