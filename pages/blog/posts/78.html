<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MeDM : Mediating Image Diffusion Models for Video-to-Video Translation with Temporal Correspondence Guidance — happy8825 - Seohyun Lee Blog</title>
    <meta name="description" content="&nbsp;



&nbsp;
&nbsp;



&nbsp;
Abstract
이 논문은 Pre-trained Image Diffusion Model을 활용한 video-to-video translation을 consistent temporal flow로 하도록 하는 MeDM을 제안하는 ">
    <link rel="stylesheet" href="../../styles.css">
    <style>
        body { 
            background: #0d0f17; 
            color: #fff; 
            font-family: 'Inter', sans-serif; 
            line-height: 1.6; 
            margin: 0; 
            padding: 2rem;
            max-width: 900px;
            margin: 0 auto;
        }
        .post-header {
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding-bottom: 2rem;
            margin-bottom: 2rem;
        }
        .post-meta {
            color: #888;
            margin-bottom: 1rem;
        }
        .post-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .post-content {
            font-size: 1.1rem;
            line-height: 1.8;
        }
        .post-content img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 1rem 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        .post-content p {
            margin-bottom: 1rem;
        }
        .post-content h1, .post-content h2, .post-content h3 {
            color: #667eea;
            margin-top: 2rem;
            margin-bottom: 1rem;
        }
        .post-content blockquote {
            border-left: 4px solid #667eea;
            padding-left: 1rem;
            margin: 1.5rem 0;
            color: #ccc;
            font-style: italic;
        }
        .post-content code {
            background: rgba(255, 255, 255, 0.1);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }
        .post-content pre {
            background: rgba(0, 0, 0, 0.3);
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
        }
        .back-link {
            display: inline-block;
            margin-bottom: 2rem;
            color: #667eea;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        .back-link:hover {
            background: rgba(102, 126, 234, 0.2);
        }
    </style>
</head>
<body>
    <a href="../../blog.html" class="back-link">← Back to Blog</a>
    
    <div class="post-header">
        <div class="post-meta">
            <span>📅 2024-07-12</span>
            <span> | 🏷️ Computer Vision Paper Review</span>
            <span> | 🔗 <a href="https://happy8825.tistory.com/18" target="_blank">Original Post</a></span>
            <span> | 📊 4 images</span>
        </div>
        <h1 class="post-title">MeDM : Mediating Image Diffusion Models for Video-to-Video Translation with Temporal Correspondence Guidance — happy8825</h1>
        
    </div>
    
    <div class="post-content">
        <p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">

</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">

</p>
<p data-ke-size="size16">&nbsp;</p>
<h3 data-ke-size="size23" id="Abstract-1"><a href="#Abstract-1">Abstract</a></h3>
<p data-ke-size="size18">이 논문은 Pre-trained Image Diffusion Model을 활용한 video-to-video translation을 consistent temporal flow로 하도록 하는 MeDM을 제안하는 논문이다. <b>Explicit Optical Flows 를 사용해서, 생성된 frame 에&nbsp; physical constrait를 주고, 독립적으로 frame-wise scores를 조정</b>한다. 이를 통해 생성된 동영상이 시간적인 일관성을 유지하는것을 <b>최적화 문제로 정의할 수 있으며</b>, 이를 <b>Closed-form solution으로 풀 수있음</b>을 논문에서 보여줄것. Pretrained 된 Stable Diffusion과의 호환 보장을 위해<b>&nbsp; latent diffusion 모델에서 observation-space scores를 변형</b>하는것도 제안이 됨. 특히 MeDM은 <b>fine-tuning이나 test time optimization이 필요없다는 점</b>에서 다른 방법들보다 우수한 성능을 보임을 확인할 수 있음.</p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style5">
<h3 data-ke-size="size23" id="Intro-1"><a href="#Intro-1">Intro</a></h3>
<p data-ke-size="size18">최근 Diffusion 모델, 특히 DALLE 나 Stable diffusion은 <b>text to image 모델</b>로, 텍스트 설명을 바탕으로 고품질의 이미지 생성이 가능해짐. InstructPix2Pix나 Controlnet은<b> Instruction-based + sturcture preserving 모델로, 텍스트 기반 image-image</b> 변환을 가능하게 함.</p>
<p data-ke-size="size18">하지만 동영상을 생성하는 과정에서 <b>시각적인 일관성을 유지하는 거는 아직 challenge</b>로 남아있음. 이 task를 해결하기 위해 많은 tesk-video 모델이 제안되었고, Imagen Video나 Make-A-Video가 있지만 computational power 이 너무 많이 듦.</p>
<p data-ke-size="size18">이런 문제를 해결하기 위해 <b>text-image 모델에 temporal aspect를 합치는 방법</b>으로 연구가 되어왔고, Pix2Video, ControlVideo등등 <i>zero-shot 방법들도 제안</i>되어, pretrained 된 image 혹은 text-image 기반의 diffusion model을 활용하여 video-video 변환을 하는 연구도 있었음.&nbsp;</p>
<p data-ke-size="size18">하지만 이런 모델들은 flickering 문제나 복잡성 문제등이 있었음</p>
<p data-ke-size="size18">이 논문에서는 이런 문제를 해결하고 <u><b>시간적으로 일관된 video 변환을 하기 위해 optical flow 를 기반으로 한 temporal correspondence guidance</b></u>를 제안함.</p>
<p data-ke-size="size18">주요 contribution 은 다음과 같음</p>
<p data-ke-size="size18">1. 동영상 frame 간 일관성 유지를 위해 optical flow를 활용한 global pixel repository를 만들었음.</p>
<p data-ke-size="size18">2. LDM에서 observation space score 변형</p>
<p data-ke-size="size18">3, 실제 응용에도 효과적임을 증명</p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style5">
<h3 data-ke-size="size23" id="Related%20Works-1"><a href="#Related%20Works-1">Related Works</a></h3>
<h4 data-ke-size="size20"><u>Diffusion-Based Video-to-Video Translation</u></h4>
<p data-ke-size="size18">비디오 diffusion 모델을 훈련하는데 computational power 이 많이 들기에, 기존 image diffusion model을 video to video diffusion을 하기 위한 <b>다양한 zero-shot 방법들이 연구되어져왔음.</b></p>
<p data-ke-size="size18">Pix2Video(2023) : pretrained 된 structure guided diffusion 랑 self attention 을 활용해 denoising step 을 변형하거나</p>
<p data-ke-size="size18">Rerender A Video :&nbsp; hierearchical inter frame restricted diffusion model을 사용해 global style and texture 를 유지하게 하는 모델</p>
<p data-ke-size="size18">등등&nbsp; <b>여러 연구들이 동영상을 다양한 스타일로 변환하는데 성공했지만, 동영상 내의 aritifact와 flickering 현상이 여전히 명확하게 보임</b></p>
<p data-ke-size="size18">&nbsp;</p>
<h4 data-ke-size="size20"><u>Meditating Multiple Diffusion Samples</u></h4>
<p data-ke-size="size18"><b>MultiDiffusion</b>은 diffusion 모델을 이용해 이미지의 특정 부분 집합(view)을 샘플링하여, <b>각 view가 서로 겹치는 부분에서 점수를 다양하게 추정</b>합니다. 이를 통해 여러 뷰가 조화를 이루도록 least square optimization을 사용하여, <b>반복적인 denoising 과정에서 view의 intersection을 평균을 내는 방식.</b></p>
<p data-ke-size="size18">하지만 주로 간단한 view 에 대해 test 를 한다면, 이 논문에서 제시한 모델은<b> 더 복잡하면서 일반적인 view</b> 를 다룬다고 한다.(예를 들면 여러 프레임에 걸쳐 있는 픽셀 등등)</p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style5">
<p data-ke-size="size18">&nbsp;</p>
<h3 data-ke-size="size23" id="Method-1"><a href="#Method-1">Method</a></h3>
<p></p><figure class="imageblock alignCenter" data-ke-mobilestyle="widthOrigin" data-origin-width="1268" data-origin-height="678" style="margin-left: 50%; transform: translateX(-50%); width: 1100px; max-width: 1100px;"><span data-url="https://blog.kakaocdn.net/dna/cRKbMW/btsIxjb1hU7/AAAAAAAAAAAAAAAAAAAAAM-Re5r-QBtSFgRngmbvB1uDcKYoJk7FDUpDkZyrd3pn/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=y5FTgFNFP2pkxNAzEdA2JjE0YGI%3D" data-phocus="https://blog.kakaocdn.net/dna/cRKbMW/btsIxjb1hU7/AAAAAAAAAAAAAAAAAAAAAM-Re5r-QBtSFgRngmbvB1uDcKYoJk7FDUpDkZyrd3pn/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=y5FTgFNFP2pkxNAzEdA2JjE0YGI%3D"><img src="https://blog.kakaocdn.net/dna/cRKbMW/btsIxjb1hU7/AAAAAAAAAAAAAAAAAAAAAM-Re5r-QBtSFgRngmbvB1uDcKYoJk7FDUpDkZyrd3pn/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=y5FTgFNFP2pkxNAzEdA2JjE0YGI%3D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2FcRKbMW%2FbtsIxjb1hU7%2FAAAAAAAAAAAAAAAAAAAAAM-Re5r-QBtSFgRngmbvB1uDcKYoJk7FDUpDkZyrd3pn%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3Dy5FTgFNFP2pkxNAzEdA2JjE0YGI%253D" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';" loading="lazy" width="1268" height="678" data-origin-width="1268" data-origin-height="678" data-phocus-index="0"></span></figure>
<p></p>
<p data-ke-size="size16">&nbsp;</p>
<h4 data-ke-size="size20"><u>Flow Coding</u></h4>
<p data-ke-size="size18">Flow Coding이란! 기본적인 아이디어는, <b>실제 물체의 한 점은 영상의 시간이 지나도 일정하게 유지</b>된다는 점에서 나온 아이디어. 예를 들어 책상의 빨간 사과는 시간이 지나도 계속 빨간색으로 보이겠지. 그럼 이 개념을 video에도 적용해서, 동일한 <b>물체의 동일한 지점을 나타내는 픽셀은 시간에 따라 동일한 색상을 유지해아 함</b>을 의미함.&nbsp;</p>
<p data-ke-size="size18">동영상에서는 특정 장면이 여러 프레임에 걸쳐 표현이 되고, 여기서 <b>각 프레임은 장면의 순간적인 'SAMPLE' 인것</b>. 각 프레임의 픽셀은 실제 세계의 특정 지점을 나타내고, 동일한 지점을 표시하는 픽셀은 일관된 색상을 가져야함.</p>
<p data-ke-size="size18">&nbsp;</p>
<p data-ke-size="size18"><u><i>이걸 구현하기 위해 제안된 방법이 바로 Flow Coding!</i></u></p>
<p data-ke-size="size18">&nbsp;</p>
<p data-ke-size="size18">Flow Coding은 각 frame 간의 <b>optical flow를 사용해 동일한 지점을 추적</b>하고, 픽셀들이 시간적으로 일관된 색상을 유지하도록 함.</p>
<p data-ke-size="size18"><i>Optical Flow</i>는 연속된 프레임간 픽셀이 이동한 방향과 거리를 나타내는 친구로, 얘를 통해 <b>각 프레임에서 동일한 지점을 나타내는 픽셀을 추적</b>할 수 있고,</p>
<p data-ke-size="size18"><i>Pixel Repository</i>는 동영상의 <b>모든 프레임에서 동일한 지점을 나타내는 픽셀들을 저장하고 관리</b>하는 친구로, <b>각 frame 은 이 저장소의 하나의 "View"라고 보면 됨</b>.</p>
<p data-ke-size="size18">&nbsp;</p>
<p data-ke-size="size18"><b>Encoding and Propogation 을 반복적</b>으로 하며 Flow Coding 을 구현할 수 있음</p>
<p data-ke-size="size18"><b>현재 프레임의 픽셀을 Encoding 해서 Repository에 추가</b>하고(이전에 encoding 되지 않은 새로운 픽셀만 추가하는 방식), <b>encoding 된 frame의 코드를 다음 frame 의 대응 pixel 로 propagate</b>를 시킴. 이 과정을 통해 모든 프레임에서 동일한 지점을 일관되게 encoding 할 수 있음.</p>
<p data-ke-size="size18">&nbsp;</p>
<p data-ke-size="size18">예시를 보자~</p>
<p data-ke-size="size18">&nbsp;</p>
<p></p><figure class="imageblock alignCenter" data-ke-mobilestyle="widthOrigin" data-origin-width="614" data-origin-height="646" style="margin-left: 50%; transform: translateX(-50%); width: 614px; max-width: 614px;"><span data-url="https://blog.kakaocdn.net/dna/cKdzcX/btsIyg0gRAT/AAAAAAAAAAAAAAAAAAAAAAg0aOX35gdfVhamfuhwWkIRf_dQmx9BoVMKOIoipT8L/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=%2BvRFNqihhJSVEvL9rwUz7MGr%2BJU%3D" data-phocus="https://blog.kakaocdn.net/dna/cKdzcX/btsIyg0gRAT/AAAAAAAAAAAAAAAAAAAAAAg0aOX35gdfVhamfuhwWkIRf_dQmx9BoVMKOIoipT8L/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=%2BvRFNqihhJSVEvL9rwUz7MGr%2BJU%3D"><img src="https://blog.kakaocdn.net/dna/cKdzcX/btsIyg0gRAT/AAAAAAAAAAAAAAAAAAAAAAg0aOX35gdfVhamfuhwWkIRf_dQmx9BoVMKOIoipT8L/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=%2BvRFNqihhJSVEvL9rwUz7MGr%2BJU%3D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2FcKdzcX%2FbtsIyg0gRAT%2FAAAAAAAAAAAAAAAAAAAAAAg0aOX35gdfVhamfuhwWkIRf_dQmx9BoVMKOIoipT8L%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3D%252BvRFNqihhJSVEvL9rwUz7MGr%252BJU%253D" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';" loading="lazy" width="614" height="646" data-origin-width="614" data-origin-height="646" data-phocus-index="1"></span></figure>
<p></p>
<p data-ke-size="size16">첫번째 X'[0]에서 왼쪽 위에 부분에 코드 0, 왼쪽 밑에 코드 2를 부여한 상태에서, 두번째 frame X'[1]에서 동일한 부분을 나타내는 픽셀이 각각 오른쪽 위, 오른쪽 아래랑 같으니까, 거기에 각각 코드 0, 코드 2를 propagate시키고, 나머지 왼쪽 부분은 처음보는 픽셀이니까 pixel repository에 넣어주고~ 이렇게 반복하다보면 각 frame 별로 pixel 들이 일관되게 연결됨.</p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style2">
<h4 style="color: #000000; text-align: start;" data-ke-size="size20"><u>Global Harmonization</u></h4>
<p data-ke-size="size18">Global Harmonization이란, Flow Coding 알고리즘을 적용한 후, 동영상 frame을 일관되게 유지하는 단계로, 이 과정에서 encoding된 frame을 사용해 denoising 하는 과정해서 consistency가 보장됨.</p>
<p data-ke-size="size18">&nbsp;</p>
<p style="color: #000000; text-align: start;" data-ke-size="size18"><b><i>1. Encoded Frames</i></b></p>
<p data-ke-size="size18"><b>XE</b>: Flow Coding 알고리즘을 통해 생성된 인코딩된 프레임을 나타냄</p>
<p data-ke-size="size18"><b>Rt[XE]</b>: 인코딩된 프레임에서 픽셀 값을 pixel repository <b>Rt</b>에서 가져오는 것을 의미한다</p>
<p data-ke-size="size18">수식에서 오른쪽에 위치하면 픽셀 값을 가져오는 역할을 하고, 왼쪽에 위치하면 픽셀 값을 저장하는 역할 (assign 비슷하게 생각하면 될듯?)</p>
<p style="color: #000000; text-align: start;" data-ke-size="size18"><i><b>2. Denoising Process</b></i></p>
<p data-ke-size="size18"><b>Xt</b>: 디퓨전 모델 t 단계에서 생성된 노이즈 샘플, 이때 이 디퓨전 모델은 시간적 정보를 포함하지 않으며, 각 동영상 프레임은 독립적으로 생성됨.</p>
<p style="color: #000000; text-align: start;" data-ke-size="size18"><i><b>3. Temporal Consistency Loss</b></i></p>
<p data-ke-size="size18">temporal consistency를 보장하기 위한 loss function으로, 인코딩된 프레임에서 픽셀 값을 가져와 현재 노이즈 샘플과 비교하여 다음과 같이 계산됨.&nbsp;</p>
<p style="text-align: center;" data-ke-size="size18"><b><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="0" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2016"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D438 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2016"></mjx-c></mjx-mo><mjx-script style="vertical-align: 0.363em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>L</mi><mi>t</mi></msub><mo>=</mo><mo data-mjx-texclass="ORD" fence="false" stretchy="false">‖</mo><mi>R</mi><mi>t</mi><mo stretchy="false">[</mo><mi>X</mi><mi>E</mi><mo stretchy="false">]</mo><mo>−</mo><mi>X</mi><mi>t</mi><msup><mo data-mjx-texclass="ORD" fence="false" stretchy="false">‖</mo><mn>2</mn></msup></math></mjx-assistive-mml></mjx-container></b></p>
<p style="color: #000000; text-align: start;" data-ke-size="size18"><i><b>4. Pixel Value Update</b></i></p>
<p data-ke-size="size18"><b>Rt[XE] ← G( <span style="color: #333333; text-align: center;">Xt<span> </span></span>)</b>: 여기서 G는 각 v프레임에서 noise smaple Xt를 조정해서 pixel repository 에 넣기 전에 일관된 값을 가지도록 만드는 역할. 간단하게 말하자면 서로 다른 프레임에서 얻어진 픽셀 값들을 harmonize 해주는 친구.</p>
<p style="color: #000000; text-align: start;" data-ke-size="size18">지금까지 process를 정리해보면</p>
<pre class="bash" style="background-color: #f4f4f4; padding: 10px; border-radius: 5px; overflow-x: auto;" data-ke-language="bash"><code class="hljs language-bash">1. Flow Coding 알고리즘 적용
   - 각 프레임의 픽셀을 인코딩하고, 인코딩되지 않은 픽셀은 pixel repository Rt에 추가.
   - 인코딩된 프레임의 코드를 다음 프레임의 대응 픽셀로 propagate.

2. Denoising 과정
   - 각 t 단계에서 모델 평가로부터 생성된 노이즈 샘플 Xt 획득.
   - 인코딩된 프레임 XE와 픽셀 저장소 Rt를 사용하여 시간적 일관성 손실 Lt 계산.

3. 시간적 일관성 손실 Lt 계산
   - Lt = ∥Rt[XE] - Xt∥²

4. G harmonization
   - 최적화 과정 G를 통해 Rt[XE] 업데이트.</code></pre>
<p data-ke-size="size18">&nbsp;</p>
<p data-ke-size="size18">그럼 아까 논문에서 이 <b>global harmonization이 closed form optimization 문제로 정의될 수 있다</b>고 했었는데, 이 global harmonization 함수를 자세히 봐보자.</p>
<p data-ke-size="size18">&nbsp;</p>
<p style="color: #333333; text-align: start;" data-ke-size="size18">다음과 같은 최적화 문제로 표현이 가능한데,</p>
<p style="color: #333333; text-align: start;" data-ke-size="size18">&nbsp;</p>
<p style="text-align: center;" data-ke-size="size18"><b><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="1" style="font-size: 115.9%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c76"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mtext></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-n" space="4"><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-munder space="2"><mjx-row><mjx-base><mjx-mo class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c6E"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top: 0.167em; padding-left: 0.556em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D43A TEX-I"></mjx-c></mjx-mi></mjx-under></mjx-row></mjx-munder><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>G</mi><mrow data-mjx-texclass="ORD"><mtext>avg</mtext></mrow></msub><mo>=</mo><mi>arg</mi><mo data-mjx-texclass="NONE">⁡</mo><munder><mo data-mjx-texclass="OP" movablelimits="true">min</mo><mi>G</mi></munder><msub><mi>L</mi><mi>t</mi></msub></math></mjx-assistive-mml></mjx-container></b></p>
<p style="text-align: center;" data-ke-size="size18">&nbsp;</p>
<p style="color: #333333; text-align: start;" data-ke-size="size18">여기서 <b>Gavg는 L_t를 최소화하는 최적의 G 값을 찾는 것을 의미</b>함. 이는 Xt의 픽셀 값들을 동일한 pixel repository Rt의 픽셀과 연관된 경우에 대해 unweighted average를 해서 시간적 일관성을 유지한다.</p>
<p data-ke-size="size18">&nbsp;</p>
<p data-ke-size="size18">여기서 그냥 개인적으로 잘 와닿지 않았던 부분이 unweighted average이랑 시간적 일관성이랑 무슨 상관이 있지.?</p>
<p data-ke-size="size18"><i>각 프레임의 픽셀 값들이 서로 비슷하게 만들어지니까, 인접한 프레임들간의 일관성이 유지되고, 이런 함수 때문에 flickering 현상을 줄일 수 있는것 같다.</i></p>
<p data-ke-size="size18">&nbsp;</p>
<p data-ke-size="size18">그리고! closed form optimization 이라는거에 대해서 논문에서는 잘 나오진 않았지만, 조금 더 수식적으로 생각해보자면</p>
<p data-ke-size="size18">Lt&nbsp;=&nbsp;∥Rt[XE]&nbsp;-&nbsp;Xt∥²</p>
<p data-ke-size="size18">이 Lt 함수가 유클리드 거리의 제곱 합이니까 볼록함수로, 최소값이 무조건 있는 함수라, 논문에서 closed form optimization이라고 쓴것 같다</p>
<p data-ke-size="size18">&nbsp;</p>
<p data-ke-size="size18">&nbsp;</p>
<h4 style="color: #000000; text-align: start;" data-ke-size="size20"><b><i> Unweighted global harmonization in Pytorch 구현 방법</i></b></h4>
<p data-ke-size="size18">논문에서 pytorch 로 구현되어있는 코드가 있어서 가져와봤다</p>
<p></p><figure class="imageblock alignCenter" data-ke-mobilestyle="widthOrigin" data-origin-width="1046" data-origin-height="258" style="margin-left: 50%; transform: translateX(-50%); width: 1046px; max-width: 1046px;"><span data-url="https://blog.kakaocdn.net/dna/bTTnqm/btsIzet1QU8/AAAAAAAAAAAAAAAAAAAAAA4HAlrO9Kld3tcy-jEZGu8mGT10oVqaKk8Eh1RhJj7S/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=7TGGzRRFIxJq48rrPfkjFfn1rK0%3D" data-phocus="https://blog.kakaocdn.net/dna/bTTnqm/btsIzet1QU8/AAAAAAAAAAAAAAAAAAAAAA4HAlrO9Kld3tcy-jEZGu8mGT10oVqaKk8Eh1RhJj7S/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=7TGGzRRFIxJq48rrPfkjFfn1rK0%3D"><img src="https://blog.kakaocdn.net/dna/bTTnqm/btsIzet1QU8/AAAAAAAAAAAAAAAAAAAAAA4HAlrO9Kld3tcy-jEZGu8mGT10oVqaKk8Eh1RhJj7S/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=7TGGzRRFIxJq48rrPfkjFfn1rK0%3D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2FbTTnqm%2FbtsIzet1QU8%2FAAAAAAAAAAAAAAAAAAAAAA4HAlrO9Kld3tcy-jEZGu8mGT10oVqaKk8Eh1RhJj7S%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3D7TGGzRRFIxJq48rrPfkjFfn1rK0%253D" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';" loading="lazy" width="1046" height="258" data-origin-width="1046" data-origin-height="258" data-phocus-index="2"></span></figure>
<p></p>
<p data-ke-size="size18"><b>1. cnt.index_put_((X_E,), 1)</b><br>cnt 텐서는 각 픽셀이 몇 번 참조되었는지를 세는 카운터로, X_E 인덱스 위치에 1을 더함. 즉, X_E에 해당하는 위치에 1을 추가하여 해당 픽셀이 몇 번 참조되었는지 카운트함.</p>
<p data-ke-size="size18"><b>2. repo.index_put_((X_E,), X_t)</b><br>repo 텐서는 각 픽셀 값들을 저장하는 친구. X_E 인덱스 위치에 X_t 값을 저장함. 즉, X_E 인덱스 위치에 X_t 값을 넣어서 픽셀 값을 업데이트함.</p>
<p data-ke-size="size18"><b>3. avg = torch.where(cnt &gt; 0, repo / cnt, repo)</b><br>cnt 값이 0보다 큰 경우, repo 값을 cnt로 나눠서 평균을 계산함. 그렇지 않은 경우, repo 값을 그대로 사용한다. 즉 각 픽셀의 평균 값을 계산하여 avg 텐서에 저장함.</p>
<p data-ke-size="size18">&nbsp;</p>
<p data-ke-size="size18">즉 Xt의 픽셀 값들을, 동일한 픽셀 repository Rt의 픽셀과 연관된 경우에 대해 unweighted averages을 하는것</p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style5">
<h4 data-ke-size="size20"><b> Mediating Image Diffusion Samples with Temporal Correspondence Guidance </b></h4>
<p style="color: #000000; text-align: start;" data-ke-size="size18"><u>Diffusion 기본 원리</u></p>
<p data-ke-size="size18">다들 알겠지만,, 디퓨전은 일정한 노이즈 스케줄링 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="2" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FC TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2208"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><msub><mi>α</mi><mi>t</mi></msub><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mi>t</mi><mo>∈</mo><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mi>T</mi><mo stretchy="false">]</mo><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml></mjx-container>랑 data point <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="3" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>X</mi><mn>0</mn></msub></math></mjx-assistive-mml></mjx-container>를 기반으로 한다. 특정 시간 단계 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="4" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml></mjx-container>에서의 노이즈 샘플 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="5" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>X</mi><mi>t</mi></msub></math></mjx-assistive-mml></mjx-container>는 다음과 같이 정의됨.</p>
<p style="text-align: center;" data-ke-size="size18"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="6" style="font-size: 115.9%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msqrt space="4"><mjx-sqrt><mjx-surd><mjx-mo class="mjx-n"><mjx-c class="mjx-c221A"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.255em;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FC TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-box></mjx-sqrt></mjx-msqrt><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msqrt space="3"><mjx-sqrt><mjx-surd><mjx-mo class="mjx-sop"><mjx-c class="mjx-c221A TEX-S1"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.243em;"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FC TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-box></mjx-sqrt></mjx-msqrt><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D716 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>X</mi><mi>t</mi></msub><mo>=</mo><msqrt><msub><mi>α</mi><mi>t</mi></msub></msqrt><msub><mi>X</mi><mn>0</mn></msub><mo>+</mo><msqrt><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>t</mi></msub></msqrt><msub><mi>ϵ</mi><mi>t</mi></msub></math></mjx-assistive-mml></mjx-container></p>
<p data-ke-size="size18">여기서 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="7" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D716 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c223C"></mjx-c></mjx-mo><mjx-texatom space="4" texclass="ORD"><mjx-mi class="mjx-cal mjx-i"><mjx-c class="mjx-c4E TEX-C"></mjx-c></mjx-mi></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D43C TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ϵ</mi><mi>t</mi></msub><mo>∼</mo><mrow data-mjx-texclass="ORD"><mi data-mjx-variant="-tex-calligraphic" mathvariant="script">N</mi></mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mi>I</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>는 가우시안 노이즈</p>
<p data-ke-size="size18">여기서 식을 다음과 같은 두 가지 형태로 표현가능함</p>
<p style="text-align: center;" data-ke-size="size18"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="8" style="font-size: 115.9%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-msqrt><mjx-sqrt><mjx-surd><mjx-mo class="mjx-n"><mjx-c class="mjx-c221A"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.208em;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FC TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-box></mjx-sqrt></mjx-msqrt></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mrow><mjx-mo class="mjx-lop"><mjx-c class="mjx-c28 TEX-S2"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msqrt space="3"><mjx-sqrt><mjx-surd><mjx-mo class="mjx-sop"><mjx-c class="mjx-c221A TEX-S1"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.243em;"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FC TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-box></mjx-sqrt></mjx-msqrt><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D716 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-lop"><mjx-c class="mjx-c29 TEX-S2"></mjx-c></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>X</mi><mn>0</mn></msub><mo>=</mo><mfrac><mn>1</mn><msqrt><msub><mi>α</mi><mi>t</mi></msub></msqrt></mfrac><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo>−</mo><msqrt><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>t</mi></msub></msqrt><msub><mi>ϵ</mi><mi>t</mi></msub><mo data-mjx-texclass="CLOSE">)</mo></mrow></math></mjx-assistive-mml></mjx-container></p>
<p style="text-align: center;" data-ke-size="size18"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="9" style="font-size: 115.9%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D716 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-msqrt><mjx-sqrt><mjx-surd><mjx-mo class="mjx-n"><mjx-c class="mjx-c221A"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.096em;"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FC TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-box></mjx-sqrt></mjx-msqrt></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mrow><mjx-mo class="mjx-sop"><mjx-c class="mjx-c28 TEX-S1"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msqrt space="3"><mjx-sqrt><mjx-surd><mjx-mo class="mjx-n"><mjx-c class="mjx-c221A"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.255em;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FC TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-box></mjx-sqrt></mjx-msqrt><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-sop"><mjx-c class="mjx-c29 TEX-S1"></mjx-c></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>ϵ</mi><mi>t</mi></msub><mo>=</mo><mfrac><mn>1</mn><msqrt><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>t</mi></msub></msqrt></mfrac><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo>−</mo><msqrt><msub><mi>α</mi><mi>t</mi></msub></msqrt><msub><mi>X</mi><mn>0</mn></msub><mo data-mjx-texclass="CLOSE">)</mo></mrow></math></mjx-assistive-mml></mjx-container></p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style2">
<p style="text-align: center;" data-ke-size="size18">&nbsp;</p>
<p style="color: #000000; text-align: start;" data-ke-size="size18"><u>Temporal Correspondence Guidance</u></p>
<p data-ke-size="size18">시간적 일관성을 유지하기 위해 pixel repository <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="10" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mi>t</mi></msub></math></mjx-assistive-mml></mjx-container>를 활용한다. 이를 통해 각 디퓨전 모델의 eval step마다 노이즈 샘플을 update 함.</p>
<p style="color: #000000; text-align: start;" data-ke-size="size18">1)Pixel repository <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="11" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mi>t</mi></msub></math></mjx-assistive-mml></mjx-container></p>
<p style="color: #000000; text-align: start;" data-ke-size="size18">2) Noise sample update</p>
<p data-ke-size="size18">각 eval step 마다 noise sample 을 새로 update 해줌</p>
<p style="text-align: center;" data-ke-size="size18"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="12" style="font-size: 115.9%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: -0.024em;"><mjx-mi class="mjx-i" size="s" style="margin-left: 0.106em;"><mjx-c class="mjx-c1D703 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.21em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2190"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: -0.024em;"><mjx-mi class="mjx-i" size="s" style="margin-left: 0.106em;"><mjx-c class="mjx-c1D703 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.21em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D438 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msubsup><mi>X</mi><mi>t</mi><mi>θ</mi></msubsup><mo stretchy="false">←</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>w</mi><mo stretchy="false">)</mo><msubsup><mi>X</mi><mi>t</mi><mi>θ</mi></msubsup><mo>+</mo><mi>w</mi><msub><mi>R</mi><mi>t</mi></msub><mo stretchy="false">[</mo><msub><mi>X</mi><mi>E</mi></msub><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></p>
<p data-ke-size="size18">여기서 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="13" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></mjx-assistive-mml></mjx-container>는 가중치(weight).&nbsp; <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="14" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.267em; margin-left: -0.024em;"><mjx-mi class="mjx-i" size="s" style="margin-left: 0.106em;"><mjx-c class="mjx-c1D703 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>X</mi><mi>t</mi><mi>θ</mi></msubsup></math></mjx-assistive-mml></mjx-container>는 디퓨전 모델이 생성한 현재 노이즈 샘플.&nbsp; <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="15" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mi>t</mi></msub></math></mjx-assistive-mml></mjx-container>에서 가져온 값 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="16" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D438 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mi>t</mi></msub><mo stretchy="false">[</mo><msub><mi>X</mi><mi>E</mi></msub><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container>와 혼합하여 temporal consistency 유지하도록 해줌.</p>
<p style="color: #000000; text-align: start;" data-ke-size="size18">3) 혹은 Score estiamation으로~</p>
<p data-ke-size="size18">노이즈 샘플 대신 노이즈 예측 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="17" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D716 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.267em; margin-left: 0px;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D703 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>ϵ</mi><mi>t</mi><mi>θ</mi></msubsup></math></mjx-assistive-mml></mjx-container>으로 update 하는 식</p>
<p style="text-align: center;" data-ke-size="size18"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="18" style="font-size: 115.9%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D716 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D703 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.21em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2190"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D716 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D703 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.21em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D716 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.21em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D438 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msubsup><mi>ϵ</mi><mi>t</mi><mi>θ</mi></msubsup><mo stretchy="false">←</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>w</mi><mo stretchy="false">)</mo><msubsup><mi>ϵ</mi><mi>t</mi><mi>θ</mi></msubsup><mo>+</mo><mi>w</mi><msubsup><mi>R</mi><mi>t</mi><mi>ϵ</mi></msubsup><mo stretchy="false">[</mo><msub><mi>X</mi><mi>E</mi></msub><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></p>
<p data-ke-size="size18">&nbsp;</p>
<p style="color: #000000; text-align: start;" data-ke-size="size18">3. LDM과의 호환성</p>
<p data-ke-size="size18">LDM과의 호환성을 위해, 노이즈 샘플 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="19" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>X</mi><mi>t</mi></msub></math></mjx-assistive-mml></mjx-container> 또는 노이즈 예측 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="20" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D716 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ϵ</mi><mi>t</mi></msub></math></mjx-assistive-mml></mjx-container>를 적절한 공간으로 변환함. 왜냐면 LDM은 pretrained된거로 직접적으로 Xt랑 노이즈 예측을 학습하지 않으니까</p>
<p style="text-align: center;" data-ke-size="size18"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="21" style="font-size: 115.9%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D716 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.21em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D438 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2190"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-msqrt><mjx-sqrt><mjx-surd><mjx-mo class="mjx-n"><mjx-c class="mjx-c221A"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.096em;"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FC TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-box></mjx-sqrt></mjx-msqrt></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mrow><mjx-mo class="mjx-lop"><mjx-c class="mjx-c28 TEX-S2"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msqrt space="3"><mjx-sqrt><mjx-surd><mjx-mo class="mjx-n"><mjx-c class="mjx-c221A"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.255em;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FC TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-box></mjx-sqrt></mjx-msqrt><mjx-msub><mjx-mi class="mjx-n"><mjx-c class="mjx-c3A6"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mrow space="2"><mjx-mo class="mjx-lop"><mjx-c class="mjx-c28 TEX-S2"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43A TEX-I"></mjx-c></mjx-mi><mjx-mrow space="2"><mjx-mo class="mjx-lop"><mjx-c class="mjx-c28 TEX-S2"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-n"><mjx-c class="mjx-c3A6"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mrow space="2"><mjx-mo class="mjx-lop"><mjx-c class="mjx-c28 TEX-S2"></mjx-c></mjx-mo><mjx-msub><mjx-texatom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.105em; padding-left: 0.515em; margin-bottom: -0.531em;"><mjx-mo class="mjx-n" style="width: 0px; margin-left: -0.25em;"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi></mjx-base></mjx-mover></mjx-texatom><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-texatom size="s" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-lop"><mjx-c class="mjx-c29 TEX-S2"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-lop"><mjx-c class="mjx-c29 TEX-S2"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-lop"><mjx-c class="mjx-c29 TEX-S2"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-lop"><mjx-c class="mjx-c29 TEX-S2"></mjx-c></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msubsup><mi>R</mi><mi>t</mi><mi>ϵ</mi></msubsup><mo stretchy="false">[</mo><msub><mi>X</mi><mi>E</mi></msub><mo stretchy="false">]</mo><mo stretchy="false">←</mo><mfrac><mn>1</mn><msqrt><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>t</mi></msub></msqrt></mfrac><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo>−</mo><msqrt><msub><mi>α</mi><mi>t</mi></msub></msqrt><msub><mi mathvariant="normal">Φ</mi><mi>e</mi></msub><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><mi>G</mi><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><msub><mi mathvariant="normal">Φ</mi><mi>d</mi></msub><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><msub><mrow data-mjx-texclass="ORD"><mover><mi>X</mi><mo stretchy="false">^</mo></mover></mrow><mrow data-mjx-texclass="ORD"><mn>0</mn><mo>,</mo><mi>t</mi></mrow></msub><mo data-mjx-texclass="CLOSE">)</mo></mrow><mo data-mjx-texclass="CLOSE">)</mo></mrow><mo data-mjx-texclass="CLOSE">)</mo></mrow><mo data-mjx-texclass="CLOSE">)</mo></mrow></math></mjx-assistive-mml></mjx-container></p>
<p data-ke-size="size18">여기서 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="22" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-n"><mjx-c class="mjx-c3A6"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">Φ</mi><mi>e</mi></msub></math></mjx-assistive-mml></mjx-container>와 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="23" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-n"><mjx-c class="mjx-c3A6"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">Φ</mi><mi>d</mi></msub></math></mjx-assistive-mml></mjx-container>는 각각 오토인코더의 인코더와 디코더</p>
<p style="color: #000000; text-align: start;" data-ke-size="size18">단계별로 다시 정리해보자면~</p>
<p data-ke-size="size18">1. **generate noise sample**:&nbsp; <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="24" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>X</mi><mn>0</mn></msub></math></mjx-assistive-mml></mjx-container>에서 노이즈 샘플 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="25" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>X</mi><mi>t</mi></msub></math></mjx-assistive-mml></mjx-container>를 생성:</p>
<p style="text-align: center;" data-ke-size="size18"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="26" style="font-size: 115.9%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msqrt space="4"><mjx-sqrt><mjx-surd><mjx-mo class="mjx-n"><mjx-c class="mjx-c221A"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.255em;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FC TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-box></mjx-sqrt></mjx-msqrt><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-msqrt space="3"><mjx-sqrt><mjx-surd><mjx-mo class="mjx-sop"><mjx-c class="mjx-c221A TEX-S1"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.243em;"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FC TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-box></mjx-sqrt></mjx-msqrt><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D716 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>X</mi><mi>t</mi></msub><mo>=</mo><msqrt><msub><mi>α</mi><mi>t</mi></msub></msqrt><msub><mi>X</mi><mn>0</mn></msub><mo>+</mo><msqrt><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>t</mi></msub></msqrt><msub><mi>ϵ</mi><mi>t</mi></msub></math></mjx-assistive-mml></mjx-container></p>
<p data-ke-size="size18">2. **pixel repository**: 시간적 일관성을 유지하기 위해 pixel repository<mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="27" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mi>t</mi></msub></math></mjx-assistive-mml></mjx-container>를 사용.<br>3. **노이즈 샘플 update**: 디퓨전 모델의 각 estimtion step마다 노이즈 샘플을 다음과 같이 update:</p>
<p style="text-align: center;" data-ke-size="size18"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="28" style="font-size: 115.9%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: -0.024em;"><mjx-mi class="mjx-i" size="s" style="margin-left: 0.106em;"><mjx-c class="mjx-c1D703 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.21em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2190"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: -0.024em;"><mjx-mi class="mjx-i" size="s" style="margin-left: 0.106em;"><mjx-c class="mjx-c1D703 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.21em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D438 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msubsup><mi>X</mi><mi>t</mi><mi>θ</mi></msubsup><mo stretchy="false">←</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>w</mi><mo stretchy="false">)</mo><msubsup><mi>X</mi><mi>t</mi><mi>θ</mi></msubsup><mo>+</mo><mi>w</mi><msub><mi>R</mi><mi>t</mi></msub><mo stretchy="false">[</mo><msub><mi>X</mi><mi>E</mi></msub><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></p>
<p data-ke-size="size18">4. **혹은 noise 예측**: 또는 스코어 추정 방법을 따르면:</p>
<p style="text-align: center;" data-ke-size="size18"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="29" style="font-size: 115.9%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D716 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D703 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.21em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2190"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D716 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D703 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.21em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D716 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.21em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D438 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msubsup><mi>ϵ</mi><mi>t</mi><mi>θ</mi></msubsup><mo stretchy="false">←</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>w</mi><mo stretchy="false">)</mo><msubsup><mi>ϵ</mi><mi>t</mi><mi>θ</mi></msubsup><mo>+</mo><mi>w</mi><msubsup><mi>R</mi><mi>t</mi><mi>ϵ</mi></msubsup><mo stretchy="false">[</mo><msub><mi>X</mi><mi>E</mi></msub><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></p>
<p data-ke-size="size18">5. **LDM과 맞추는 과**: LDM은 noise 샘플 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="30" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>X</mi><mi>t</mi></msub></math></mjx-assistive-mml></mjx-container> 또는 noise 예측 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="31" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D716 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ϵ</mi><mi>t</mi></msub></math></mjx-assistive-mml></mjx-container>를 직접 학습하지 않음으로, 이를 적절한 공간으로 변환하기 위해 다음과 같은 식으로 update 해줌</p>
<p style="text-align: center;" data-ke-size="size18"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="32" style="font-size: 115.9%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D716 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.21em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D438 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2190"></mjx-c></mjx-mo><mjx-mfrac space="4"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-msqrt><mjx-sqrt><mjx-surd><mjx-mo class="mjx-n"><mjx-c class="mjx-c221A"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.096em;"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FC TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-box></mjx-sqrt></mjx-msqrt></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mrow><mjx-mo class="mjx-lop"><mjx-c class="mjx-c28 TEX-S2"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msqrt space="3"><mjx-sqrt><mjx-surd><mjx-mo class="mjx-n"><mjx-c class="mjx-c221A"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.255em;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FC TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-box></mjx-sqrt></mjx-msqrt><mjx-msub><mjx-mi class="mjx-n"><mjx-c class="mjx-c3A6"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mrow space="2"><mjx-mo class="mjx-lop"><mjx-c class="mjx-c28 TEX-S2"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43A TEX-I"></mjx-c></mjx-mi><mjx-mrow space="2"><mjx-mo class="mjx-lop"><mjx-c class="mjx-c28 TEX-S2"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-n"><mjx-c class="mjx-c3A6"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mrow space="2"><mjx-mo class="mjx-lop"><mjx-c class="mjx-c28 TEX-S2"></mjx-c></mjx-mo><mjx-msub><mjx-texatom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.105em; padding-left: 0.515em; margin-bottom: -0.531em;"><mjx-mo class="mjx-n" style="width: 0px; margin-left: -0.25em;"><mjx-c class="mjx-c5E"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi></mjx-base></mjx-mover></mjx-texatom><mjx-script style="vertical-align: -0.15em; margin-left: -0.024em;"><mjx-texatom size="s" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-lop"><mjx-c class="mjx-c29 TEX-S2"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-lop"><mjx-c class="mjx-c29 TEX-S2"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-lop"><mjx-c class="mjx-c29 TEX-S2"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-lop"><mjx-c class="mjx-c29 TEX-S2"></mjx-c></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msubsup><mi>R</mi><mi>t</mi><mi>ϵ</mi></msubsup><mo stretchy="false">[</mo><msub><mi>X</mi><mi>E</mi></msub><mo stretchy="false">]</mo><mo stretchy="false">←</mo><mfrac><mn>1</mn><msqrt><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>t</mi></msub></msqrt></mfrac><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo>−</mo><msqrt><msub><mi>α</mi><mi>t</mi></msub></msqrt><msub><mi mathvariant="normal">Φ</mi><mi>e</mi></msub><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><mi>G</mi><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><msub><mi mathvariant="normal">Φ</mi><mi>d</mi></msub><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><msub><mrow data-mjx-texclass="ORD"><mover><mi>X</mi><mo stretchy="false">^</mo></mover></mrow><mrow data-mjx-texclass="ORD"><mn>0</mn><mo>,</mo><mi>t</mi></mrow></msub><mo data-mjx-texclass="CLOSE">)</mo></mrow><mo data-mjx-texclass="CLOSE">)</mo></mrow><mo data-mjx-texclass="CLOSE">)</mo></mrow><mo data-mjx-texclass="CLOSE">)</mo></mrow></math></mjx-assistive-mml></mjx-container></p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style2">
<p data-ke-size="size18"><u>Enhancing Video Sharpness</u></p>
<p data-ke-size="size16">디퓨전 모델에서 independent하게 score estimation 값을 harmonizing 할 떄,<b> 비디오가 흐릿하게 보이는 문제</b>가 생김. <b>optical flow 랑 diffusion model의 estimation 값의 시각적 구조 차이</b> 때문이라고 함 (예를 들면 물체 위치가 약간 다르게 생성될 수도 있고, 동일한 물체의 형태가 약간씩 다르게 생성된 수도 있고, 색상이 다르게 생성될 수도 있고)</p>
<p data-ke-size="size16">그래서 이걸 해결하기 위해 <b>SDEdit과 ControlNet 이 도입되었음.</b></p>
<h3 data-ke-size="size23" id="%C2%A0-1"><a href="#%C2%A0-1">&nbsp;</a></h3>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style5">
<h3 data-ke-size="size23" id="Experiment-1"><a href="#Experiment-1">Experiment</a></h3>
<p></p><figure class="imageblock alignCenter" data-ke-mobilestyle="widthOrigin" data-origin-width="1128" data-origin-height="672" style="margin-left: 50%; transform: translateX(-50%); width: 1100px; max-width: 1100px;"><span data-url="https://blog.kakaocdn.net/dna/IjqKr/btsIzxmzOgV/AAAAAAAAAAAAAAAAAAAAACX1bre369B3sxkxUKMSbnyt_y3ikbWg6sPt-mr_gMfw/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=%2B04EVlm9CvAgTfFYkACWJcbm%2BvM%3D" data-phocus="https://blog.kakaocdn.net/dna/IjqKr/btsIzxmzOgV/AAAAAAAAAAAAAAAAAAAAACX1bre369B3sxkxUKMSbnyt_y3ikbWg6sPt-mr_gMfw/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=%2B04EVlm9CvAgTfFYkACWJcbm%2BvM%3D"><img src="https://blog.kakaocdn.net/dna/IjqKr/btsIzxmzOgV/AAAAAAAAAAAAAAAAAAAAACX1bre369B3sxkxUKMSbnyt_y3ikbWg6sPt-mr_gMfw/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=%2B04EVlm9CvAgTfFYkACWJcbm%2BvM%3D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2FIjqKr%2FbtsIzxmzOgV%2FAAAAAAAAAAAAAAAAAAAAACX1bre369B3sxkxUKMSbnyt_y3ikbWg6sPt-mr_gMfw%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3D%252B04EVlm9CvAgTfFYkACWJcbm%252BvM%253D" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';" loading="lazy" width="1128" height="672" data-origin-width="1128" data-origin-height="672" data-phocus-index="3"></span></figure>
<p></p>
<p data-ke-size="size16">&nbsp;</p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style5">
<p data-ke-size="size16">개인적인 생각..?</p>
<p data-ke-size="size16">Optical Flow 에 크게 의존하는것 같음 ( 새로운 데이터셋에서 optical flow 계산이 정확하지 않으면 consistency가 유지되지 않을 것 같음)</p>
<p data-ke-size="size16">픽셀들을 고유한 코드로 인코딩할때, 각 픽셀별로 인코딩시키는게 아니라 특정 크기의 볼록으로 나누어 인코딩하는 하는거 같은데</p>
<p data-ke-size="size16">그럼 discretization 오류가 생길 것 같음, 작은 디테일을 캐치 못할 것 같기도?</p>
<p data-ke-size="size16">혹은&nbsp; 움직임이 빠르거나 복잡한 장면을 잘 catch 할 수 있을까?</p>
    </div>
    
    <div style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid rgba(255,255,255,0.1); text-align: center;">
        <a href="../../blog.html" class="back-link">← Back to Blog</a>
    </div>
</body>
</html>
