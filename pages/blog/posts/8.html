<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scaling up Test-Time Compute with Latent Reasoning: A Recurrent Depth Approach — happy8825 - Seohyun Lee Blog</title>
    <meta name="description" content="Scaling up Test time compute 하기 위한 아주 novel한 방법을 제안하는 논문이다. 보통은 Chain of thought을 하면서 모델이 더 많은 토큰을 뱉도록 하는 방식으로 scaling 을 했는데, 이렇게 하면 inference 할때 Sequenth lengt">
    <link rel="stylesheet" href="../../styles.css">
    <style>
        body { 
            background: #0d0f17; 
            color: #fff; 
            font-family: 'Inter', sans-serif; 
            line-height: 1.6; 
            margin: 0; 
            padding: 2rem;
            max-width: 900px;
            margin: 0 auto;
        }
        .post-header {
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding-bottom: 2rem;
            margin-bottom: 2rem;
        }
        .post-meta {
            color: #888;
            margin-bottom: 1rem;
        }
        .post-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .post-content {
            font-size: 1.1rem;
            line-height: 1.8;
        }
        .post-content img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 1rem 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        .post-content p {
            margin-bottom: 1rem;
        }
        .post-content h1, .post-content h2, .post-content h3 {
            color: #667eea;
            margin-top: 2rem;
            margin-bottom: 1rem;
        }
        .post-content blockquote {
            border-left: 4px solid #667eea;
            padding-left: 1rem;
            margin: 1.5rem 0;
            color: #ccc;
            font-style: italic;
        }
        .post-content code {
            background: rgba(255, 255, 255, 0.1);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }
        .post-content pre {
            background: rgba(0, 0, 0, 0.3);
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
        }
        .back-link {
            display: inline-block;
            margin-bottom: 2rem;
            color: #667eea;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        .back-link:hover {
            background: rgba(102, 126, 234, 0.2);
        }
    </style>
</head>
<body>
    <a href="../../blog.html" class="back-link">← Back to Blog</a>
    
    <div class="post-header">
        <div class="post-meta">
            <span>📅 2025-04-20</span>
            <span> | 🏷️ Computer Vision Paper Review</span>
            <span> | 🔗 <a href="https://happy8825.tistory.com/105" target="_blank">Original Post</a></span>
            <span> | 📊 7 images</span>
        </div>
        <h1 class="post-title">Scaling up Test-Time Compute with Latent Reasoning: A Recurrent Depth Approach — happy8825</h1>
        
    </div>
    
    <div class="post-content">
        <p data-ke-size="size18">Scaling up Test time compute 하기 위한 아주 novel한 방법을 제안하는 논문이다. 보통은 Chain of thought을 하면서 모델이 더 많은 토큰을 뱉도록 하는 방식으로 scaling 을 했는데, 이렇게 하면 inference 할때 Sequenth length 가 길어질수록, memory 사용량이 linear 하게 증가하는 문제가 있다. 이 논문에서는 이런 비효율적인 memory 사용량을&nbsp; recurrent 모델을 통해서 해결을 한다. 단순히 많은 토큰을 내뱉게 해서 test time compute을 scaling up 하는 대신에, recurrent 모델을 쓰는데 어떻게 했는지 하나씩 보자.</p>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style5">
<h4 data-ke-size="size20"><b>Model Architecture</b></h4>
<p></p><figure class="imageblock alignCenter" data-ke-mobilestyle="widthOrigin" data-origin-width="959" data-origin-height="262" style="margin-left: 50%; transform: translateX(-50%); width: 959px; max-width: 959px;"><span data-url="https://blog.kakaocdn.net/dna/7aHx6/btsNtkWQsGE/AAAAAAAAAAAAAAAAAAAAAD7ZUzLj28hPIBNBzjqOuZ7JcunDUWDrO-AIV5R-z0gu/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=PRt4%2BHvaz7UOuYZnWOZrN4uFe1g%3D" data-phocus="https://blog.kakaocdn.net/dna/7aHx6/btsNtkWQsGE/AAAAAAAAAAAAAAAAAAAAAD7ZUzLj28hPIBNBzjqOuZ7JcunDUWDrO-AIV5R-z0gu/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=PRt4%2BHvaz7UOuYZnWOZrN4uFe1g%3D"><img src="https://blog.kakaocdn.net/dna/7aHx6/btsNtkWQsGE/AAAAAAAAAAAAAAAAAAAAAD7ZUzLj28hPIBNBzjqOuZ7JcunDUWDrO-AIV5R-z0gu/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=PRt4%2BHvaz7UOuYZnWOZrN4uFe1g%3D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2F7aHx6%2FbtsNtkWQsGE%2FAAAAAAAAAAAAAAAAAAAAAD7ZUzLj28hPIBNBzjqOuZ7JcunDUWDrO-AIV5R-z0gu%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3DPRt4%252BHvaz7UOuYZnWOZrN4uFe1g%253D" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';" loading="lazy" width="959" height="262" data-origin-width="959" data-origin-height="262" data-phocus-index="0"></span></figure>
<p></p>
<p data-ke-size="size18">아이디어만 보자면, 우선 hello 에 대한 latent output e가 normal distribution에서 sampling된 S0과 합쳐져서 s1 이 나온다. 그리고 이 s1 이 다시 e 와 합쳐져서 s2가 나오고~~ 이런식으로 쭉 반복해서, 마지막에는 Sr 이 나온다. 이거를 transformer 에 태워서 다음에 최종적으로 next prediction을 하게 된다.</p>
<p data-ke-size="size18">&nbsp;</p>
<p data-ke-size="size18">위 그림을 식으로 표현하면 다음과 같다.</p>
<p></p><figure class="imageblock alignCenter" data-ke-mobilestyle="widthOrigin" data-origin-width="1047" data-origin-height="376" style="margin-left: 50%; transform: translateX(-50%); width: 1047px; max-width: 1047px;"><span data-url="https://blog.kakaocdn.net/dna/L80uo/btsNsQWa6ry/AAAAAAAAAAAAAAAAAAAAACRYWK7QppIKm3jhMKuQSNwmFgjO1BA5qGjqIHHUE8Kj/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=q7nm1r7nixIltumQsUXdBLWungg%3D" data-phocus="https://blog.kakaocdn.net/dna/L80uo/btsNsQWa6ry/AAAAAAAAAAAAAAAAAAAAACRYWK7QppIKm3jhMKuQSNwmFgjO1BA5qGjqIHHUE8Kj/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=q7nm1r7nixIltumQsUXdBLWungg%3D"><img src="https://blog.kakaocdn.net/dna/L80uo/btsNsQWa6ry/AAAAAAAAAAAAAAAAAAAAACRYWK7QppIKm3jhMKuQSNwmFgjO1BA5qGjqIHHUE8Kj/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=q7nm1r7nixIltumQsUXdBLWungg%3D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2FL80uo%2FbtsNsQWa6ry%2FAAAAAAAAAAAAAAAAAAAAACRYWK7QppIKm3jhMKuQSNwmFgjO1BA5qGjqIHHUE8Kj%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3Dq7nm1r7nixIltumQsUXdBLWungg%253D" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';" loading="lazy" width="1047" height="376" data-origin-width="1047" data-origin-height="376" data-phocus-index="1"></span></figure>
<p></p>
<p data-ke-size="size18">이 식이 뭘 의미하는지 위에서부터 하나씩 자세히 보자.</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size18"><b>1) 첫번쨰 식 (e=p(x))</b></p>
<p></p><figure class="imageblock alignCenter" data-ke-mobilestyle="widthOrigin" data-origin-width="1956" data-origin-height="617" style="margin-left: 50%; transform: translateX(-50%); width: 1100px; max-width: 1100px;"><span data-url="https://blog.kakaocdn.net/dna/HZsxI/btsNsi6Yfjc/AAAAAAAAAAAAAAAAAAAAAGK3UVZpFOif_pYsLW4wt7JuaoCEe1tRaBShV3FHaaoj/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=cpa9damvG5OjhUWfoeHBcOaWE3A%3D" data-phocus="https://blog.kakaocdn.net/dna/HZsxI/btsNsi6Yfjc/AAAAAAAAAAAAAAAAAAAAAGK3UVZpFOif_pYsLW4wt7JuaoCEe1tRaBShV3FHaaoj/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=cpa9damvG5OjhUWfoeHBcOaWE3A%3D"><img src="https://blog.kakaocdn.net/dna/HZsxI/btsNsi6Yfjc/AAAAAAAAAAAAAAAAAAAAAGK3UVZpFOif_pYsLW4wt7JuaoCEe1tRaBShV3FHaaoj/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=cpa9damvG5OjhUWfoeHBcOaWE3A%3D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2FHZsxI%2FbtsNsi6Yfjc%2FAAAAAAAAAAAAAAAAAAAAAGK3UVZpFOif_pYsLW4wt7JuaoCEe1tRaBShV3FHaaoj%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3Dcpa9damvG5OjhUWfoeHBcOaWE3A%253D" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';" loading="lazy" width="1956" height="617" data-origin-width="1956" data-origin-height="617" data-phocus-index="2"></span></figure>
<p></p>
<p data-ke-size="size18">x가 들어오면 일단 vocab 차원으로 맞춰주고, 이걸 encoding을 통해 (n x h)&nbsp; hidden state 차원으로 맞춰서 transformer 에 태운다.&nbsp;</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size18"><b>2) 두번째, 세번째 식</b></p>
<p></p><figure class="imageblock alignCenter" data-ke-mobilestyle="widthOrigin" data-origin-width="2558" data-origin-height="1423" style="margin-left: 50%; transform: translateX(-50%); width: 1100px; max-width: 1100px;"><span data-url="https://blog.kakaocdn.net/dna/c5SVTb/btsNsmBhgK3/AAAAAAAAAAAAAAAAAAAAAASTSQ-5kusqZFY6jRJ03O0ygRuTzf24gyObyl0kdjbo/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=VdskpPsLMC9yu50ci6cC7IVZF8w%3D" data-phocus="https://blog.kakaocdn.net/dna/c5SVTb/btsNsmBhgK3/AAAAAAAAAAAAAAAAAAAAAASTSQ-5kusqZFY6jRJ03O0ygRuTzf24gyObyl0kdjbo/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=VdskpPsLMC9yu50ci6cC7IVZF8w%3D"><img src="https://blog.kakaocdn.net/dna/c5SVTb/btsNsmBhgK3/AAAAAAAAAAAAAAAAAAAAAASTSQ-5kusqZFY6jRJ03O0ygRuTzf24gyObyl0kdjbo/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=VdskpPsLMC9yu50ci6cC7IVZF8w%3D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2Fc5SVTb%2FbtsNsmBhgK3%2FAAAAAAAAAAAAAAAAAAAAAASTSQ-5kusqZFY6jRJ03O0ygRuTzf24gyObyl0kdjbo%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3DVdskpPsLMC9yu50ci6cC7IVZF8w%253D" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';" loading="lazy" width="2558" height="1423" data-origin-width="2558" data-origin-height="1423" data-phocus-index="3"></span></figure>
<p></p>
<p data-ke-size="size18"><span style="text-align: start;">&nbsp;(e=p(x))를 통해 나온 e와, S0 (노이즈) 를 섞어서, concat을 시킨다. 그럼 (nxh) + (nxh) 니까 (nx2h) 가 되니까, 인코더를 태워서 다시 nxh 로 맞춰준다. 그리고 transformer를 태워서 RMS norm 까지 거치면 Si가 나온다.</span></p>
<p data-ke-size="size18"><span style="text-align: start;">이거를 다시 원래 첫번째 식에서 나온 e랑 다시 섞어서 concat을 하고 똑같은 과정을 계속 recurrent 하게 반복한다.</span></p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size18"><b>3) 네번째 식</b></p>
<p></p><figure class="imageblock alignCenter" data-ke-mobilestyle="widthOrigin" data-origin-width="2605" data-origin-height="786" style="margin-left: 50%; transform: translateX(-50%); width: 1100px; max-width: 1100px;"><span data-url="https://blog.kakaocdn.net/dna/NN17m/btsNsNL9YLR/AAAAAAAAAAAAAAAAAAAAANjAlDmNiwLY5p972isVJYXwggejk7T8znANilDDQFoJ/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=JHi8q9zY2lmZcQEa4jz%2BIokoPrc%3D" data-phocus="https://blog.kakaocdn.net/dna/NN17m/btsNsNL9YLR/AAAAAAAAAAAAAAAAAAAAANjAlDmNiwLY5p972isVJYXwggejk7T8znANilDDQFoJ/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=JHi8q9zY2lmZcQEa4jz%2BIokoPrc%3D"><img src="https://blog.kakaocdn.net/dna/NN17m/btsNsNL9YLR/AAAAAAAAAAAAAAAAAAAAANjAlDmNiwLY5p972isVJYXwggejk7T8znANilDDQFoJ/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=JHi8q9zY2lmZcQEa4jz%2BIokoPrc%3D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2FNN17m%2FbtsNsNL9YLR%2FAAAAAAAAAAAAAAAAAAAAANjAlDmNiwLY5p972isVJYXwggejk7T8znANilDDQFoJ%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3DJHi8q9zY2lmZcQEa4jz%252BIokoPrc%253D" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';" loading="lazy" width="2605" height="786" data-origin-width="2605" data-origin-height="786" data-phocus-index="4"></span></figure>
<p></p>
<h4 data-ke-size="size20">마지막 recurrent를 쭉 돌려서 나온 Sr을 transformer를 태우고 디코더를 태워서 (nxv) vocab size 차원에 맞춘 p를 output 하면 끝!</h4>
<hr contenteditable="false" data-ke-type="horizontalRule" data-ke-style="style5">
<h4 data-ke-size="size20"><b> Training Objective</b></h4>


<p data-ke-size="size18"><span style="font-size: 16px; letter-spacing: 0px;">전체 loss function은 다음과 같다.</span></p>
<p></p><figure class="imageblock alignCenter" data-ke-mobilestyle="widthOrigin" data-origin-width="602" data-origin-height="102" style="margin-left: 50%; transform: translateX(-50%); width: 602px; max-width: 602px;"><span data-url="https://blog.kakaocdn.net/dna/ck4JIn/btsNsbfYvh6/AAAAAAAAAAAAAAAAAAAAAJJ9AGhMpn0W4qUvGyueD8OPR6MzickJHW4GkiAWb5Rp/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=KBfuYCCQLpRcCcukIJd7X15oAxo%3D" data-phocus="https://blog.kakaocdn.net/dna/ck4JIn/btsNsbfYvh6/AAAAAAAAAAAAAAAAAAAAAJJ9AGhMpn0W4qUvGyueD8OPR6MzickJHW4GkiAWb5Rp/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=KBfuYCCQLpRcCcukIJd7X15oAxo%3D"><img src="https://blog.kakaocdn.net/dna/ck4JIn/btsNsbfYvh6/AAAAAAAAAAAAAAAAAAAAAJJ9AGhMpn0W4qUvGyueD8OPR6MzickJHW4GkiAWb5Rp/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=KBfuYCCQLpRcCcukIJd7X15oAxo%3D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2Fck4JIn%2FbtsNsbfYvh6%2FAAAAAAAAAAAAAAAAAAAAAJJ9AGhMpn0W4qUvGyueD8OPR6MzickJHW4GkiAWb5Rp%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3DKBfuYCCQLpRcCcukIJd7X15oAxo%253D" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';" loading="lazy" width="602" height="102" data-origin-width="602" data-origin-height="102" data-phocus-index="5"></span></figure>
<p></p>
<p data-ke-size="size18">여기서 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="0" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D703 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>r</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>은 입력 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="1" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container>에 대해 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="2" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></mjx-assistive-mml></mjx-container>번 반복하여 생성한 모델 출력이고, <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="3" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.363em;"><mjx-mo class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mo data-mjx-alternate="1">′</mo></msup></math></mjx-assistive-mml></mjx-container>는 시퀀스 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="4" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container>를 왼쪽으로 한 칸 shift한 값으로, 다음 토큰들이다. 즉, 모델이 생성한 다음 토큰과 실제 정답 토큰의 차이를 비교해 loss를 계산한다. <b>여기까지는 일반적인 next token prediction loss이다.</b></p>
<p data-ke-size="size18">&nbsp;</p>
<p data-ke-size="size18"><span style="text-align: start;">&nbsp;<mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="5" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-texatom texclass="ORD"><mjx-mi class="mjx-ds mjx-b"><mjx-c class="mjx-c1D53C TEX-A"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.153em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c223C"></mjx-c></mjx-mo><mjx-mi class="mjx-n"><mjx-c class="mjx-c39B"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow data-mjx-texclass="ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow data-mjx-texclass="ORD"><mi>r</mi><mo>∼</mo><mi mathvariant="normal">Λ</mi></mrow></msub></math></mjx-assistive-mml></mjx-container> 이 부분이 조금 특이해서 잘 봐야하는데</span></p>
<p></p><figure class="imageblock alignCenter" data-ke-mobilestyle="widthOrigin" data-origin-width="918" data-origin-height="641" style="margin-left: 50%; transform: translateX(-50%); width: 918px; max-width: 918px;"><span data-url="https://blog.kakaocdn.net/dna/psXld/btsNsag2UcM/AAAAAAAAAAAAAAAAAAAAAL_PdysclycPGaiigf7uF3VBUD1gg6KPv9vGwKA9Eyls/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=MRhS7JIYOrrq8jDEjl0hgvUmqKA%3D" data-phocus="https://blog.kakaocdn.net/dna/psXld/btsNsag2UcM/AAAAAAAAAAAAAAAAAAAAAL_PdysclycPGaiigf7uF3VBUD1gg6KPv9vGwKA9Eyls/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=MRhS7JIYOrrq8jDEjl0hgvUmqKA%3D"><img src="https://blog.kakaocdn.net/dna/psXld/btsNsag2UcM/AAAAAAAAAAAAAAAAAAAAAL_PdysclycPGaiigf7uF3VBUD1gg6KPv9vGwKA9Eyls/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=MRhS7JIYOrrq8jDEjl0hgvUmqKA%3D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2FpsXld%2FbtsNsag2UcM%2FAAAAAAAAAAAAAAAAAAAAAL_PdysclycPGaiigf7uF3VBUD1gg6KPv9vGwKA9Eyls%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3DMRhS7JIYOrrq8jDEjl0hgvUmqKA%253D" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';" loading="lazy" width="918" height="641" data-origin-width="918" data-origin-height="641" data-phocus-index="6"></span></figure>
<p></p>
<p data-ke-size="size18">반복 횟수 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="6" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></mjx-assistive-mml></mjx-container>은 log-normal Poisson 분포를 따르며, 평균 반복 횟수가 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="7" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-texatom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.105em; padding-left: 0.281em; margin-bottom: -0.544em;"><mjx-mo class="mjx-n" style="width: 0px; margin-left: -0.25em;"><mjx-c class="mjx-cAF"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-base></mjx-mover></mjx-texatom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow data-mjx-texclass="ORD"><mover><mi>r</mi><mo stretchy="false">¯</mo></mover></mrow><mo>+</mo><mn>1</mn></math></mjx-assistive-mml></mjx-container>이 되도록 다음의 절차를 통해 샘플링한다.</p>
<ol style="list-style-type: decimal;" data-ke-list-type="decimal">
<li>먼저 로그 정규 분포를 따르는 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="8" style="font-size: 116%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70F TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi></math></mjx-assistive-mml></mjx-container>를 샘플링한다:<mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="9" style="font-size: 116%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c223C"></mjx-c></mjx-mo><mjx-texatom space="4" texclass="ORD"><mjx-mi class="mjx-cal mjx-i"><mjx-c class="mjx-c4E TEX-C"></mjx-c></mjx-mi></mjx-texatom><mjx-mrow space="2"><mjx-mo class="mjx-s3"><mjx-c class="mjx-c28 TEX-S3"></mjx-c></mjx-mo><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.105em; padding-left: 0.281em; margin-bottom: -0.544em;"><mjx-mo class="mjx-n" style="width: 0px; margin-left: -0.25em;"><mjx-c class="mjx-cAF"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-base></mjx-mover></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mfrac space="3"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D70E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-s3"><mjx-c class="mjx-c29 TEX-S3"></mjx-c></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>τ</mi><mo>∼</mo><mrow data-mjx-texclass="ORD"><mi data-mjx-variant="-tex-calligraphic" mathvariant="script">N</mi></mrow><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mo stretchy="false">(</mo><mrow data-mjx-texclass="ORD"><mover><mi>r</mi><mo stretchy="false">¯</mo></mover></mrow><mo stretchy="false">)</mo><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mi>σ</mi><mn>2</mn></msup><mo>,</mo><mi>σ</mi><mo data-mjx-texclass="CLOSE">)</mo></mrow></math></mjx-assistive-mml></mjx-container></li>
<li>이후 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="10" style="font-size: 116%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70F TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi></math></mjx-assistive-mml></mjx-container>의 지수값을 평균으로 하는 포아송 분포에서 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="11" style="font-size: 116%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></mjx-assistive-mml></mjx-container>을 샘플링하고, 최종적으로 1을 더해준다:<mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="12" style="font-size: 116%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c223C"></mjx-c></mjx-mo><mjx-texatom space="4" texclass="ORD"><mjx-mi class="mjx-cal mjx-i"><mjx-c class="mjx-c50 TEX-C"></mjx-c></mjx-mi></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.413em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D70F TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>r</mi><mo>∼</mo><mrow data-mjx-texclass="ORD"><mi data-mjx-variant="-tex-calligraphic" mathvariant="script">P</mi></mrow><mo stretchy="false">(</mo><msup><mi>e</mi><mi>τ</mi></msup><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></math></mjx-assistive-mml></mjx-container></li>
</ol>
<p data-ke-size="size18">이렇게 하면 평균은 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="13" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-texatom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.105em; padding-left: 0.281em; margin-bottom: -0.544em;"><mjx-mo class="mjx-n" style="width: 0px; margin-left: -0.25em;"><mjx-c class="mjx-cAF"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-base></mjx-mover></mjx-texatom><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow data-mjx-texclass="ORD"><mover><mi>r</mi><mo stretchy="false">¯</mo></mover></mrow><mo>+</mo><mn>1</mn></math></mjx-assistive-mml></mjx-container>이 되며, 대부분의 값은 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="14" style="font-size: 115.9%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-texatom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom: 0.105em; padding-left: 0.281em; margin-bottom: -0.544em;"><mjx-mo class="mjx-n" style="width: 0px; margin-left: -0.25em;"><mjx-c class="mjx-cAF"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-base></mjx-mover></mjx-texatom></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow data-mjx-texclass="ORD"><mover><mi>r</mi><mo stretchy="false">¯</mo></mover></mrow></math></mjx-assistive-mml></mjx-container>보다 작지만 가끔 매우 큰 반복 횟수가 샘플링되는 heavy tail 분포의 특성을 갖는다. 이로 인해 모델은 일반적인 경우와 드물지만 긴 시퀀스까지 모두 잘 처리할 수 있도록 학습된다.</p>
    </div>
    
    <div style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid rgba(255,255,255,0.1); text-align: center;">
        <a href="../../blog.html" class="back-link">← Back to Blog</a>
    </div>
</body>
</html>
