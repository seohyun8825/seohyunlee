<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UniControl: A Unified Diffusion Model for Controllable Visual Generation in the wild — happy8825 - Seohyun Lee Blog</title>
    <meta name="description" content="

1. 기존 Generative model(stable diffusion 등등)의 한계
기존 Stable Diffusion과 같은 text-image 모델은 다양한 언어 prompt를 통해 이미지 생성하는데는 아주 뛰어나지만, 특정 공간적이거나 구조적인 control 하는게 어려움. ">
    <link rel="stylesheet" href="../../styles.css">
    <style>
        body { 
            background: #0d0f17; 
            color: #fff; 
            font-family: 'Inter', sans-serif; 
            line-height: 1.6; 
            margin: 0; 
            padding: 2rem;
            max-width: 900px;
            margin: 0 auto;
        }
        .post-header {
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding-bottom: 2rem;
            margin-bottom: 2rem;
        }
        .post-meta {
            color: #888;
            margin-bottom: 1rem;
        }
        .post-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .post-content {
            font-size: 1.1rem;
            line-height: 1.8;
        }
        .post-content img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 1rem 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        .post-content p {
            margin-bottom: 1rem;
        }
        .post-content h1, .post-content h2, .post-content h3 {
            color: #667eea;
            margin-top: 2rem;
            margin-bottom: 1rem;
        }
        .post-content blockquote {
            border-left: 4px solid #667eea;
            padding-left: 1rem;
            margin: 1.5rem 0;
            color: #ccc;
            font-style: italic;
        }
        .post-content code {
            background: rgba(255, 255, 255, 0.1);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }
        .post-content pre {
            background: rgba(0, 0, 0, 0.3);
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
        }
        .back-link {
            display: inline-block;
            margin-bottom: 2rem;
            color: #667eea;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        .back-link:hover {
            background: rgba(102, 126, 234, 0.2);
        }
    </style>
</head>
<body>
    <a href="../../blog.html" class="back-link">← Back to Blog</a>
    
    <div class="post-header">
        <div class="post-meta">
            <span>📅 2024-07-06</span>
            <span> | 🏷️ Computer Vision Paper Review</span>
            <span> | 🔗 <a href="https://happy8825.tistory.com/14" target="_blank">Original Post</a></span>
            <span> | 📊 10 images</span>
        </div>
        <h1 class="post-title">UniControl: A Unified Diffusion Model for Controllable Visual Generation in the wild — happy8825</h1>
        
    </div>
    
    <div class="post-content">
        

<h2 data-ke-size="size26" id="1.%20%EA%B8%B0%EC%A1%B4%20Generative%20model(stable%20diffusion%20%EB%93%B1%EB%93%B1)%EC%9D%98%20%ED%95%9C%EA%B3%84-1"><a href="#1.%20%EA%B8%B0%EC%A1%B4%20Generative%20model(stable%20diffusion%20%EB%93%B1%EB%93%B1)%EC%9D%98%20%ED%95%9C%EA%B3%84-1">1. 기존 Generative model(stable diffusion 등등)의 한계</a></h2>
<p data-ke-size="size16">기존 Stable Diffusion과 같은 text-image 모델은 다양한 언어 prompt를 통해 이미지 생성하는데는 아주 뛰어나지만, 특정 공간적이거나 구조적인 control 하는게 어려움. Stable diffusion 뿐만 아니라 현재 이미지 generative 모델은 여러 조건을 하나의 통합된 모델에서 처리하는데 어려움을 겪고 있음.</p>
<h2 data-ke-size="size26" id="2.%20ControlNet%EC%9D%98%20%ED%95%9C%EA%B3%84-1"><a href="#2.%20ControlNet%EC%9D%98%20%ED%95%9C%EA%B3%84-1">2. ControlNet의 한계</a></h2>
<p data-ke-size="size16">최근 나온 ControlNet에서는 visual condition을 추가할 수 있게 되었지만, ControlNet은 하나의 modality에 대한 조건만 받아들일 수 있다는 한계점이 있음(edge map 같은 condition).</p>
<p data-ke-size="size16">따라서, 이 논문에서 제안하는 모델은 UniControl로, 제어 가능한 조건(language and visual condition을 모두 handle) -&gt; 이미지를 만드는 것을 하나의 프레임워크로 통합하면서, 다양한 임의의 프롬프트까지 줄 수 있는 모델.</p>
<h2 data-ke-size="size26" id="3.%20Training%20Setup-1"><a href="#3.%20Training%20Setup-1">3. Training Setup</a></h2>
<p data-ke-size="size16">이전의 stable diffusion 또는 ControlNet 과 같은 생성 모델과 달리, 시각 condition이랑 텍스트 condition을 동시에 받아야하니까, 이걸 하기 위해 학습 condition이랑 target을 pair 시켜 데이터셋을 구성함.</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">K개의 task로 구성된 데이터셋이 있다고 가정하면</p>
<p style="text-align: center;" data-ke-size="size16">&nbsp;D := {D1 ∪ · · · ∪ DK}</p>
<p data-ke-size="size16">각 task training set Dk에 대해, 학습 쌍을 ([ctext, ctask], Ic, x)로 나타내는것.</p>
<p data-ke-size="size16">(여기서 ctask는 task 유형, ctext는 target 이미지를 설명하는 language prompt, Ic는 image condtition, x는 타겟 이미지)&nbsp;</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">예시를 보자</p>
<p></p><figure class="imageblock alignCenter" data-ke-mobilestyle="widthOrigin" data-origin-width="996" data-origin-height="214" style="margin-left: 50%; transform: translateX(-50%); width: 996px; max-width: 996px;"><span data-url="https://blog.kakaocdn.net/dna/b3EmK5/btsIrx7OKGz/AAAAAAAAAAAAAAAAAAAAAKX_H_HQHxtTfOwKLEycIbn8v_wvGnWeNKVVMngochkl/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=NKOyf8peIXZAW%2FcOqk0Nnkyh8t8%3D" data-phocus="https://blog.kakaocdn.net/dna/b3EmK5/btsIrx7OKGz/AAAAAAAAAAAAAAAAAAAAAKX_H_HQHxtTfOwKLEycIbn8v_wvGnWeNKVVMngochkl/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=NKOyf8peIXZAW%2FcOqk0Nnkyh8t8%3D"><img src="https://blog.kakaocdn.net/dna/b3EmK5/btsIrx7OKGz/AAAAAAAAAAAAAAAAAAAAAKX_H_HQHxtTfOwKLEycIbn8v_wvGnWeNKVVMngochkl/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=NKOyf8peIXZAW%2FcOqk0Nnkyh8t8%3D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2Fb3EmK5%2FbtsIrx7OKGz%2FAAAAAAAAAAAAAAAAAAAAAKX_H_HQHxtTfOwKLEycIbn8v_wvGnWeNKVVMngochkl%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3DNKOyf8peIXZAW%252FcOqk0Nnkyh8t8%253D" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';" loading="lazy" width="996" height="214" data-origin-width="996" data-origin-height="214" data-phocus-index="0"></span></figure>
<p></p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">여기서 task 는 Canny Edge 를 따라서 image를 생성하는것.</p>
<p data-ke-size="size16">아까&nbsp; 만들어놓은 학습쌍</p>
<p data-ke-size="size16">( [ctask, ctext], Ic, x)를 사용하여 task 별&nbsp; 학습 손실을 LDM 공식에 다음과 같이 적용시킬 수 었음.</p>
<p style="text-align: center;" data-ke-size="size16"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="0" style="font-size: 116%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c2113"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D703 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-ds mjx-b"><mjx-c class="mjx-c1D53C TEX-A"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D716 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c6B"></mjx-c></mjx-mtext></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c78"></mjx-c><mjx-c class="mjx-c74"></mjx-c></mjx-mtext></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43C TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.064em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-texatom></mjx-script></mjx-msub><mjx-mrow space="2"><mjx-mo class="mjx-sop"><mjx-c class="mjx-c5B TEX-S1"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2016"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D716 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D716 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D703 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c6B"></mjx-c></mjx-mtext></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c78"></mjx-c><mjx-c class="mjx-c74"></mjx-c></mjx-mtext></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43C TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.064em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2016"></mjx-c></mjx-mo><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-spacer style="margin-top: 0.189em;"></mjx-spacer><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msubsup><mjx-mo class="mjx-sop"><mjx-c class="mjx-c5D TEX-S1"></mjx-c></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>ℓ</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>:=</mo><msub><mrow data-mjx-texclass="ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow data-mjx-texclass="ORD"><mi>z</mi><mo>,</mo><mi>ϵ</mi><mo>,</mo><mi>t</mi><mo>,</mo><msub><mi>c</mi><mrow data-mjx-texclass="ORD"><mtext>task</mtext></mrow></msub><mo>,</mo><msub><mi>c</mi><mrow data-mjx-texclass="ORD"><mtext>text</mtext></mrow></msub><mo>,</mo><msub><mi>I</mi><mi>c</mi></msub></mrow></msub><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mo data-mjx-texclass="ORD" fence="false" stretchy="false">‖</mo><mi>ϵ</mi><mo>−</mo><msub><mi>ϵ</mi><mrow data-mjx-texclass="ORD"><mi>θ</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>z</mi><mi>t</mi></msub><mo>,</mo><mi>t</mi><mo>,</mo><msub><mi>c</mi><mrow data-mjx-texclass="ORD"><mtext>task</mtext></mrow></msub><mo>,</mo><msub><mi>c</mi><mrow data-mjx-texclass="ORD"><mtext>text</mtext></mrow></msub><mo>,</mo><msub><mi>I</mi><mi>c</mi></msub><mo stretchy="false">)</mo><msubsup><mo data-mjx-texclass="ORD" fence="false" stretchy="false">‖</mo><mn>2</mn><mn>2</mn></msubsup><mo data-mjx-texclass="CLOSE">]</mo></mrow></math></mjx-assistive-mml></mjx-container></p>
<p style="text-align: center;" data-ke-size="size16">, <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="1" style="font-size: 116%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c6B"></mjx-c></mjx-mtext></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c78"></mjx-c><mjx-c class="mjx-c74"></mjx-c></mjx-mtext></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43C TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.064em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c223C"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D437 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo stretchy="false">(</mo><mo stretchy="false">[</mo><msub><mi>c</mi><mrow data-mjx-texclass="ORD"><mtext>task</mtext></mrow></msub><mo>,</mo><msub><mi>c</mi><mrow data-mjx-texclass="ORD"><mtext>text</mtext></mrow></msub><mo stretchy="false">]</mo><mo>,</mo><msub><mi>I</mi><mi>c</mi></msub><mo>,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>∼</mo><msub><mi>D</mi><mi>k</mi></msub></math></mjx-assistive-mml></mjx-container></p>
<p data-ke-size="size16">여기서 t는 시간 단계를 나타내고, <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="2" style="font-size: 116%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>z</mi><mi>t</mi></msub></math></mjx-assistive-mml></mjx-container>는 시간 단계 t에서 노이즈가 추가된 latent tensor이며, <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="3" style="font-size: 116%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D438 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>z</mi><mn>0</mn></msub><mo>=</mo><mi>E</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>이고, <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="4" style="font-size: 116%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D703 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></mjx-assistive-mml></mjx-container>는 UniControl의 learnable parameter.</p>
<p data-ke-size="size16">&nbsp;먼저 무작위로 과제 k를 선택하고 Dk에서 미니 매치를 샘플링하여 계산된 손실 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="5" style="font-size: 116%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c2113"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D703 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ℓ</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>로 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="6" style="font-size: 116%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D703 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></mjx-assistive-mml></mjx-container>를 최적화하는 방식으로 학습이 이루어짐.</p>
<p data-ke-size="size16">&nbsp;</p>
<h2 data-ke-size="size26" id="4.%20Model%20Design-1"><a href="#4.%20Model%20Design-1">4. Model Design</a></h2>
<p data-ke-size="size16">가장 중요한 Model Design을 보자~</p>
<p data-ke-size="size16">UniControl은 두가지 property를 만족하기 위해 설계 되었는데,</p>
<p data-ke-size="size16">1) The model can overcome misalighnment of low-level features from different tasks</p>
<p data-ke-size="size16">2) THe model can learn meta-knowledge across tasks, and adapt to each task effectively</p>
<p data-ke-size="size16">즉,&nbsp; Unicontrol 은 각각의 task의 필수적이고 unique 한&nbsp; 정보를 각가 알 수 있어야하고 ( 즉 condition으로segementation map이 들어갔으면 아웃풋도 segmentation 관련된거, 3d 정보를 포함해서는 안됨. 각 task 별로 뚜렷한 정보를 가지고 있어야함)</p>
<p data-ke-size="size16">그리고! 모델은 서로 다른 task 들의 차이점이나 유사성을 알 수 있어야함.(뒤에 나오겠지만 zero shot learning 같은것을 해서 안 본 task에 대해서도 학습을 시키려면 각각 task들의 differences를 모델이 명확하게 알고 있어야함.)&nbsp;</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">그러기 위해 두가지 novel 한 module 이 소개되었음.(MOE-Style Adapter, task-aware HyperNet)</p>
<p></p><figure class="imageblock alignCenter" data-ke-mobilestyle="widthOrigin" data-origin-width="1658" data-origin-height="1252" style="margin-left: 50%; transform: translateX(-50%); width: 1100px; max-width: 1100px;"><span data-url="https://blog.kakaocdn.net/dna/KC7jr/btsIpKOlfnZ/AAAAAAAAAAAAAAAAAAAAACAXhMwst6Ku3JnRrTUnaX5Mdvfw8CCLlKdva9s5AlBf/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=ZsaikDNhV4N426mvYMJJ9zzJKEU%3D" data-phocus="https://blog.kakaocdn.net/dna/KC7jr/btsIpKOlfnZ/AAAAAAAAAAAAAAAAAAAAACAXhMwst6Ku3JnRrTUnaX5Mdvfw8CCLlKdva9s5AlBf/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=ZsaikDNhV4N426mvYMJJ9zzJKEU%3D"><img src="https://blog.kakaocdn.net/dna/KC7jr/btsIpKOlfnZ/AAAAAAAAAAAAAAAAAAAAACAXhMwst6Ku3JnRrTUnaX5Mdvfw8CCLlKdva9s5AlBf/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=ZsaikDNhV4N426mvYMJJ9zzJKEU%3D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2FKC7jr%2FbtsIpKOlfnZ%2FAAAAAAAAAAAAAAAAAAAAACAXhMwst6Ku3JnRrTUnaX5Mdvfw8CCLlKdva9s5AlBf%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3DZsaikDNhV4N426mvYMJJ9zzJKEU%253D" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';" loading="lazy" width="1658" height="1252" data-origin-width="1658" data-origin-height="1252" data-phocus-index="1"></span></figure>
<p></p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">&nbsp;</p>
<h2 data-ke-size="size26" id="MOE-Style%20Adapter-1"><a href="#MOE-Style%20Adapter-1">MOE-Style Adapter</a></h2>
<p></p><figure class="imageblock alignCenter" data-ke-mobilestyle="widthOrigin" data-origin-width="1018" data-origin-height="326" style="margin-left: 50%; transform: translateX(-50%); width: 1018px; max-width: 1018px;"><span data-url="https://blog.kakaocdn.net/dna/buQAH1/btsIpzsLr6s/AAAAAAAAAAAAAAAAAAAAAKHXrO8mfAfKkGa4Klh_Sg7GXg0G6WAUrsDVXgyHHb4R/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=egEYJ3oCbdTryEOtxhvZWiecU74%3D" data-phocus="https://blog.kakaocdn.net/dna/buQAH1/btsIpzsLr6s/AAAAAAAAAAAAAAAAAAAAAKHXrO8mfAfKkGa4Klh_Sg7GXg0G6WAUrsDVXgyHHb4R/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=egEYJ3oCbdTryEOtxhvZWiecU74%3D"><img src="https://blog.kakaocdn.net/dna/buQAH1/btsIpzsLr6s/AAAAAAAAAAAAAAAAAAAAAKHXrO8mfAfKkGa4Klh_Sg7GXg0G6WAUrsDVXgyHHb4R/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=egEYJ3oCbdTryEOtxhvZWiecU74%3D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2FbuQAH1%2FbtsIpzsLr6s%2FAAAAAAAAAAAAAAAAAAAAAKHXrO8mfAfKkGa4Klh_Sg7GXg0G6WAUrsDVXgyHHb4R%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3DegEYJ3oCbdTryEOtxhvZWiecU74%253D" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';" loading="lazy" width="1018" height="326" data-origin-width="1018" data-origin-height="326" data-phocus-index="2"></span></figure>
<p></p>
<div class="code">
<p data-ke-size="size16">간단하게 얘기하자면,</p>
<p data-ke-size="size16">&nbsp;다양한&nbsp; image condition에서 low feature를 학습하여 UniControl이 adpative 하게 각 task의 unique 한 특징을 캡처할 수 있도록 하는 것.</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">여기서 사용된 아이디어는 LLM에서 쓰이는 Mixture-of -Experts 의 아이디어가 적용되는데</p>
<h4 data-ke-size="size20">MOE</h4>
<figure class="imageblock alignCenter" data-ke-mobilestyle="widthOrigin" data-origin-width="600" data-origin-height="335" style="margin-left: 50%; transform: translateX(-50%); width: 600px; max-width: 600px;"><span data-url="https://blog.kakaocdn.net/dna/2tweE/btsIpvKG2vq/AAAAAAAAAAAAAAAAAAAAAOZgkBze31pzeY8uF_o8GE6Jod6z5vOo0OxHX7O-YyKi/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=HkEuQFYPXUKr6po8T%2FR1hn%2BiIoE%3D" data-phocus="https://blog.kakaocdn.net/dna/2tweE/btsIpvKG2vq/AAAAAAAAAAAAAAAAAAAAAOZgkBze31pzeY8uF_o8GE6Jod6z5vOo0OxHX7O-YyKi/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=HkEuQFYPXUKr6po8T%2FR1hn%2BiIoE%3D" data-alt="MOE ( Mixture-of-Experts)"><img src="https://blog.kakaocdn.net/dna/2tweE/btsIpvKG2vq/AAAAAAAAAAAAAAAAAAAAAOZgkBze31pzeY8uF_o8GE6Jod6z5vOo0OxHX7O-YyKi/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=HkEuQFYPXUKr6po8T%2FR1hn%2BiIoE%3D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2F2tweE%2FbtsIpvKG2vq%2FAAAAAAAAAAAAAAAAAAAAAOZgkBze31pzeY8uF_o8GE6Jod6z5vOo0OxHX7O-YyKi%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3DHkEuQFYPXUKr6po8T%252FR1hn%252BiIoE%253D" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';" loading="lazy" width="600" height="335" data-origin-width="600" data-origin-height="335" data-phocus-index="3"></span><figcaption>MOE ( Mixture-of-Experts)</figcaption>
</figure>

<p data-ke-size="size16">&nbsp;</p>
<p style="color: #333333; text-align: center;" data-ke-size="size16"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="7" style="font-size: 116%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-munderover space="4"><mjx-over style="padding-bottom: 0.192em; padding-left: 0.51em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo class="mjx-lop"><mjx-c class="mjx-c2211 TEX-S2"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top: 0.167em; padding-left: 0.148em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-texatom space="2" texclass="ORD"><mjx-mn class="mjx-b"><mjx-c class="mjx-c1D7CF TEX-B"></mjx-c></mjx-mn></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D454 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.06em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>y</mi><mo>=</mo><munderover><mo data-mjx-texclass="OP">∑</mo><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow data-mjx-texclass="ORD"><mi>n</mi></mrow></munderover><mrow data-mjx-texclass="ORD"><mn mathvariant="bold">1</mn></mrow><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>i</mi><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>f</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></p>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="8" style="font-size: 116%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D454 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>는 입력 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="9" style="font-size: 116%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container>에 대한 expert의 선택을 결정하는 함수</li>
<li><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="10" style="font-size: 116%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.06em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>는 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="11" style="font-size: 116%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml></mjx-container>-번째 expert 의 출력</li>
</ul>
<p data-ke-size="size16">즉 여러 expert에 대한 의견을 gate를 통해 통과시켜 각각 다른 가중치를 곱해 합치는 느낌. (g(x)의 합은 1)</p>
<p data-ke-size="size16">여기서는 g도 학습가능한 함수</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16"><b>그럼 여기서 뭐가 바뀌었을까?</b></p>
<p data-ke-size="size16">&nbsp;</p>
<h4 data-ke-size="size20">MOE-Style Adapter</h4>
<p data-ke-size="size16"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="12" style="font-size: 116%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D439 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.153em; margin-left: -0.106em;"><mjx-texatom size="s" texclass="ORD"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c41"></mjx-c><mjx-c class="mjx-c64"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c70"></mjx-c><mjx-c class="mjx-c74"></mjx-c><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c72"></mjx-c></mjx-mtext></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43C TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: -0.064em;"><mjx-mi class="mjx-i" size="s" style="margin-left: 0.166em;"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.34em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3A"></mjx-c><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-munderover space="4"><mjx-over style="padding-bottom: 0.2em; padding-left: 0.408em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43E TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo class="mjx-lop"><mjx-c class="mjx-c2211 TEX-S2"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top: 0.167em; padding-left: 0.148em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-texatom space="2" texclass="ORD"><mjx-mn class="mjx-b"><mjx-c class="mjx-c1D7CF TEX-B"></mjx-c></mjx-mn></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-msubsup space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D439 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.325em; margin-left: -0.106em;"><mjx-texatom size="s" texclass="ORD" style="margin-left: 0.228em;"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-texatom><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-texatom size="s" texclass="ORD"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c43"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c76"></mjx-c><mjx-c class="mjx-c31"></mjx-c></mjx-mtext></mjx-texatom></mjx-script></mjx-msubsup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2218"></mjx-c></mjx-mo><mjx-msubsup space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D439 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.325em; margin-left: -0.106em;"><mjx-texatom size="s" texclass="ORD" style="margin-left: 0.228em;"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-texatom><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-texatom size="s" texclass="ORD"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c43"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c76"></mjx-c><mjx-c class="mjx-c32"></mjx-c></mjx-mtext></mjx-texatom></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43C TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: -0.064em;"><mjx-mi class="mjx-i" size="s" style="margin-left: 0.166em;"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.34em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>F</mi><mrow data-mjx-texclass="ORD"><mtext>Adapter</mtext></mrow></msub><mo stretchy="false">(</mo><msubsup><mi>I</mi><mi>c</mi><mi>k</mi></msubsup><mo stretchy="false">)</mo><mo>:=</mo><munderover><mo data-mjx-texclass="OP">∑</mo><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow data-mjx-texclass="ORD"><mi>K</mi></mrow></munderover><mrow data-mjx-texclass="ORD"><mn mathvariant="bold">1</mn></mrow><mo stretchy="false">(</mo><mi>i</mi><mo>==</mo><mi>k</mi><mo stretchy="false">)</mo><mo>⋅</mo><msubsup><mi>F</mi><mrow data-mjx-texclass="ORD"><mtext>Cov1</mtext></mrow><mrow data-mjx-texclass="ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>∘</mo><msubsup><mi>F</mi><mrow data-mjx-texclass="ORD"><mtext>Cov2</mtext></mrow><mrow data-mjx-texclass="ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup><mo stretchy="false">(</mo><msubsup><mi>I</mi><mi>c</mi><mi>k</mi></msubsup><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></p>
<p data-ke-size="size16">여기서,</p>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="13" style="font-size: 116%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-texatom texclass="ORD"><mjx-mn class="mjx-b"><mjx-c class="mjx-c1D7CF TEX-B"></mjx-c></mjx-mn></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow data-mjx-texclass="ORD"><mn mathvariant="bold">1</mn></mrow><mo stretchy="false">(</mo><mo>⋅</mo><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>은 인디케이터 함수</li>
<li><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="14" style="font-size: 116%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43C TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: -0.064em;"><mjx-mi class="mjx-i" size="s" style="margin-left: 0.166em;"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.29em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>I</mi><mi>c</mi><mi>k</mi></msubsup></math></mjx-assistive-mml></mjx-container>는 task <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="15" style="font-size: 116%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></mjx-assistive-mml></mjx-container>의 condition 이미지</li>
<li><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="16" style="font-size: 116%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D439 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.325em; margin-left: -0.106em;"><mjx-texatom size="s" texclass="ORD" style="margin-left: 0.228em;"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-texatom><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-texatom size="s" texclass="ORD"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c43"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c76"></mjx-c><mjx-c class="mjx-c31"></mjx-c></mjx-mtext></mjx-texatom></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D439 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.325em; margin-left: -0.106em;"><mjx-texatom size="s" texclass="ORD" style="margin-left: 0.228em;"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-texatom><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-texatom size="s" texclass="ORD"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c43"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c76"></mjx-c><mjx-c class="mjx-c32"></mjx-c></mjx-mtext></mjx-texatom></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>F</mi><mrow data-mjx-texclass="ORD"><mtext>Cov1</mtext></mrow><mrow data-mjx-texclass="ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>,</mo><msubsup><mi>F</mi><mrow data-mjx-texclass="ORD"><mtext>Cov2</mtext></mrow><mrow data-mjx-texclass="ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup></math></mjx-assistive-mml></mjx-container>는 어댑터의 <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="17" style="font-size: 116%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml></mjx-container>-번째 모듈의 컨볼루션 레이어</li>
</ul>
<p data-ke-size="size16">원래 MOE랑 비교했을떄 gate 함수가, 단순 1(i==k)로 바뀌었음을 알 수 있음. 즉 현재 task가 K에 해당하면 가중치가 1, 아니라면 가중치가 0인걸로 해버림.</p>
<p data-ke-size="size16">이렇게 하면 task 별로 명확하게 구분이 되고, 추가적으로 parameter수도 확 줄어서 efficient 함.</p>
<p data-ke-size="size16">(실제로 conventional 한 MOE로 했을떄 모델이 task 를 명확히 구분하지 못했다고 함. 아마 컨디션이 gate 통해서 weight를 곱하는 형태면 다른 컨디션들끼리 합쳐져서 그런것 같음)</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">&nbsp;</p>
<h2 style="color: #000000; text-align: start;" data-ke-size="size26">Task-Aware HyperNet</h2>
<p data-ke-size="size16">Task-Aware HyperNet은 Controlnet 에서 제시된&nbsp; zero-convolution module&nbsp; 을 변형한것으로,</p>
<p data-ke-size="size16">Controlnet 의 zero-convolution module 을 먼저 보자&nbsp;</p>
<h4 data-ke-size="size20">Controlnet 의 zero-convoluion module</h4>
<figure class="imageblock alignCenter" data-ke-mobilestyle="widthOrigin" data-origin-width="1082" data-origin-height="680" style="margin-left: 50%; transform: translateX(-50%); width: 1082px; max-width: 1082px;"><span data-url="https://blog.kakaocdn.net/dna/kPOGB/btsIp0ckQl5/AAAAAAAAAAAAAAAAAAAAAHPrjUk9NXisF5GtProg5qbnkue1v2vyIL803K8TySxO/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=UF9YNV3mIoDd621QUaMXezZ6NrU%3D" data-phocus="https://blog.kakaocdn.net/dna/kPOGB/btsIp0ckQl5/AAAAAAAAAAAAAAAAAAAAAHPrjUk9NXisF5GtProg5qbnkue1v2vyIL803K8TySxO/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=UF9YNV3mIoDd621QUaMXezZ6NrU%3D"><img src="https://blog.kakaocdn.net/dna/kPOGB/btsIp0ckQl5/AAAAAAAAAAAAAAAAAAAAAHPrjUk9NXisF5GtProg5qbnkue1v2vyIL803K8TySxO/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=UF9YNV3mIoDd621QUaMXezZ6NrU%3D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2FkPOGB%2FbtsIp0ckQl5%2FAAAAAAAAAAAAAAAAAAAAAHPrjUk9NXisF5GtProg5qbnkue1v2vyIL803K8TySxO%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3DUF9YNV3mIoDd621QUaMXezZ6NrU%253D" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';" loading="lazy" width="1082" height="680" data-origin-width="1082" data-origin-height="680" data-phocus-index="4"></span></figure>

<p data-ke-size="size16">&nbsp;</p>
</div>
<div class="code">&nbsp;</div>
<p data-ke-size="size16">뭔가 resnet 이랑 느낌이 미슷한듯?</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">x라는 입력을 뉴럴 네트워크에 학습한거를 lock하고 copy를 하나 해버림. 그 copy한거에 컨디션을 추가하는 것. 구체적으로는 C(condition)을 zero convolution을 통과시켜 x랑 합쳐준거를 복사한 neural network에 통과 시키고, 다시 zero convolution을 해서 , y 아웃풋 전에 더해주는 것.</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">이렇게 하면 기존 feature 도 잘 보존되고, 동시에 conditioning 도 할 수 있게 됨.</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size18"><b>그럼 다시&nbsp; UniControl Model 을 보자!</b></p>
<p data-ke-size="size16">&nbsp;</p>
<p></p><figure class="imageblock alignCenter" data-ke-mobilestyle="widthOrigin" data-origin-width="1432" data-origin-height="1044" style="margin-left: 50%; transform: translateX(-50%); width: 1100px; max-width: 1100px;"><span data-url="https://blog.kakaocdn.net/dna/uXqbg/btsIpgAeqIy/AAAAAAAAAAAAAAAAAAAAAEPkBN_enmPRORfK2oIm0Z02qSSXgHkjFy8L1IrCx6-1/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=WeCV7576RwUCjaW9AT0FEfEk214%3D" data-phocus="https://blog.kakaocdn.net/dna/uXqbg/btsIpgAeqIy/AAAAAAAAAAAAAAAAAAAAAEPkBN_enmPRORfK2oIm0Z02qSSXgHkjFy8L1IrCx6-1/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=WeCV7576RwUCjaW9AT0FEfEk214%3D"><img src="https://blog.kakaocdn.net/dna/uXqbg/btsIpgAeqIy/AAAAAAAAAAAAAAAAAAAAAEPkBN_enmPRORfK2oIm0Z02qSSXgHkjFy8L1IrCx6-1/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=WeCV7576RwUCjaW9AT0FEfEk214%3D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2FuXqbg%2FbtsIpgAeqIy%2FAAAAAAAAAAAAAAAAAAAAAEPkBN_enmPRORfK2oIm0Z02qSSXgHkjFy8L1IrCx6-1%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3DWeCV7576RwUCjaW9AT0FEfEk214%253D" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';" loading="lazy" width="1432" height="1044" data-origin-width="1432" data-origin-height="1044" data-phocus-index="5"></span></figure>
<p></p>
<p data-ke-size="size16">MOE Adapter 에서 나온 feature map이 visual condition이 되어서 zero conv 를 통과.</p>
<p data-ke-size="size16">Task Aware Hypernet은 task instruction을 처리하는데, 다음과 같이 task instruction이 들어가면 CLIP을 통해 encoding 시키고 여러 linear layer 를 거쳐서 Task embedding을 만들어줌.&nbsp;</p>
<p></p><figure class="imageblock alignCenter" data-ke-mobilestyle="widthOrigin" data-origin-width="886" data-origin-height="474" style="margin-left: 50%; transform: translateX(-50%); width: 886px; max-width: 886px;"><span data-url="https://blog.kakaocdn.net/dna/r6VJt/btsIrtkavtn/AAAAAAAAAAAAAAAAAAAAABTw7NEefm0rWYzbj9CbC50AigGMBvsnalBnbK0iwfqy/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=CgSThT8m3w1EIfDhlLLBZZoC7ew%3D" data-phocus="https://blog.kakaocdn.net/dna/r6VJt/btsIrtkavtn/AAAAAAAAAAAAAAAAAAAAABTw7NEefm0rWYzbj9CbC50AigGMBvsnalBnbK0iwfqy/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=CgSThT8m3w1EIfDhlLLBZZoC7ew%3D"><img src="https://blog.kakaocdn.net/dna/r6VJt/btsIrtkavtn/AAAAAAAAAAAAAAAAAAAAABTw7NEefm0rWYzbj9CbC50AigGMBvsnalBnbK0iwfqy/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=CgSThT8m3w1EIfDhlLLBZZoC7ew%3D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2Fr6VJt%2FbtsIrtkavtn%2FAAAAAAAAAAAAAAAAAAAAABTw7NEefm0rWYzbj9CbC50AigGMBvsnalBnbK0iwfqy%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3DCgSThT8m3w1EIfDhlLLBZZoC7ew%253D" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';" loading="lazy" width="886" height="474" data-origin-width="886" data-origin-height="474" data-phocus-index="6"></span></figure>
<p></p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">이렇게 해서 만들어진 Task Embedding은 다음과 같이 zero convolution의 weight에 곱해지는 형태로 들어감.</p>
<p></p><figure class="imageblock alignCenter" data-ke-mobilestyle="widthOrigin" data-origin-width="864" data-origin-height="540" style="margin-left: 50%; transform: translateX(-50%); width: 864px; max-width: 864px;"><span data-url="https://blog.kakaocdn.net/dna/HY6EM/btsIpF0GIli/AAAAAAAAAAAAAAAAAAAAABDbDyexJI2LitTEu2fn_QActREl6b_uZIrb9et0-d7R/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=5sJDUpBz0lwTP8h3amzHLJ58sQ0%3D" data-phocus="https://blog.kakaocdn.net/dna/HY6EM/btsIpF0GIli/AAAAAAAAAAAAAAAAAAAAABDbDyexJI2LitTEu2fn_QActREl6b_uZIrb9et0-d7R/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=5sJDUpBz0lwTP8h3amzHLJ58sQ0%3D"><img src="https://blog.kakaocdn.net/dna/HY6EM/btsIpF0GIli/AAAAAAAAAAAAAAAAAAAAABDbDyexJI2LitTEu2fn_QActREl6b_uZIrb9et0-d7R/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=5sJDUpBz0lwTP8h3amzHLJ58sQ0%3D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2FHY6EM%2FbtsIpF0GIli%2FAAAAAAAAAAAAAAAAAAAAABDbDyexJI2LitTEu2fn_QActREl6b_uZIrb9et0-d7R%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3D5sJDUpBz0lwTP8h3amzHLJ58sQ0%253D" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';" loading="lazy" width="864" height="540" data-origin-width="864" data-origin-height="540" data-phocus-index="7"></span></figure>
<p></p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">이렇게 최종 zero conv 에서 나온 애는 Decoder 로 넘어가서 이미지를 생성하게 되는 원리.</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">&nbsp;</p>
<h3 data-ke-size="size23" id="5.%20Task%20Generalization%20Ability-1"><a href="#5.%20Task%20Generalization%20Ability-1">5. Task Generalization Ability</a></h3>
<p data-ke-size="size18">Hybrid Tasks Generalization</p>
<p></p><figure class="imageblock alignCenter" data-ke-mobilestyle="widthOrigin" data-origin-width="1118" data-origin-height="392" style="margin-left: 50%; transform: translateX(-50%); width: 1100px; max-width: 1100px;"><span data-url="https://blog.kakaocdn.net/dna/xW57d/btsIp0jb6FX/AAAAAAAAAAAAAAAAAAAAABnyv_sxlpoqX4pJLnynG9yS_hHIIqouFa-I5lbS6jyk/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=WVNuaPmTYhcM5lYnsIqL5hOjC70%3D" data-phocus="https://blog.kakaocdn.net/dna/xW57d/btsIp0jb6FX/AAAAAAAAAAAAAAAAAAAAABnyv_sxlpoqX4pJLnynG9yS_hHIIqouFa-I5lbS6jyk/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=WVNuaPmTYhcM5lYnsIqL5hOjC70%3D"><img src="https://blog.kakaocdn.net/dna/xW57d/btsIp0jb6FX/AAAAAAAAAAAAAAAAAAAAABnyv_sxlpoqX4pJLnynG9yS_hHIIqouFa-I5lbS6jyk/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=WVNuaPmTYhcM5lYnsIqL5hOjC70%3D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2FxW57d%2FbtsIp0jb6FX%2FAAAAAAAAAAAAAAAAAAAAABnyv_sxlpoqX4pJLnynG9yS_hHIIqouFa-I5lbS6jyk%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3DWVNuaPmTYhcM5lYnsIqL5hOjC70%253D" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';" loading="lazy" width="1118" height="392" data-origin-width="1118" data-origin-height="392" data-phocus-index="8"></span></figure>
<p></p>
<p data-ke-size="size16">인풋으로 두가지 condition을 넣으면, 예를들어 background, foreground가 들어가면 이거를 다시 hybrid task instruction으로 rewrite 되어, segementation map and human skeleton to image 로 합쳐짐.</p>
<p data-ke-size="size18">&nbsp;</p>
<p data-ke-size="size18">&nbsp;</p>
<p data-ke-size="size18">Zero-Shot New tasks Generalization</p>
<p></p><figure class="imageblock widthContent" data-ke-mobilestyle="widthOrigin" data-origin-width="538" data-origin-height="208"><span data-url="https://blog.kakaocdn.net/dna/cmU8hu/btsIqVBqDHG/AAAAAAAAAAAAAAAAAAAAACiVA8fj9xDBLCqGQARa8nntLvZdCWinXwp5zMoDGNrV/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=f1yNHcxIHUDgVDDZrHqNcWhte%2BI%3D" data-phocus="https://blog.kakaocdn.net/dna/cmU8hu/btsIqVBqDHG/AAAAAAAAAAAAAAAAAAAAACiVA8fj9xDBLCqGQARa8nntLvZdCWinXwp5zMoDGNrV/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=f1yNHcxIHUDgVDDZrHqNcWhte%2BI%3D"><img src="https://blog.kakaocdn.net/dna/cmU8hu/btsIqVBqDHG/AAAAAAAAAAAAAAAAAAAAACiVA8fj9xDBLCqGQARa8nntLvZdCWinXwp5zMoDGNrV/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&amp;expires=1759244399&amp;allow_ip=&amp;allow_referer=&amp;signature=f1yNHcxIHUDgVDDZrHqNcWhte%2BI%3D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdna%2FcmU8hu%2FbtsIqVBqDHG%2FAAAAAAAAAAAAAAAAAAAAACiVA8fj9xDBLCqGQARa8nntLvZdCWinXwp5zMoDGNrV%2Fimg.png%3Fcredential%3DyqXZFxpELC7KVnFOS48ylbz2pIh7yKj8%26expires%3D1759244399%26allow_ip%3D%26allow_referer%3D%26signature%3Df1yNHcxIHUDgVDDZrHqNcWhte%252BI%253D" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';" loading="lazy" width="538" height="208" data-origin-width="538" data-origin-height="208" data-phocus-index="9"></span></figure>
<p></p>
<p data-ke-size="size16">처음 보는 visual condition에 대해서도, MOE style adapter 이 task wieght 를 적당하게 선형조합해서, 새로운 visual condition에 대해서도 generate 할 수 있게 됨.</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">zero shot 이 되는 이유가,</p>
<p data-ke-size="size16">pretrained 된 작업이랑<b>&nbsp;새로운 작업 간의 공통 속성과 암묵적인 상관관계</b>를 모델이 잘 이해하고 활용했기 때문인것 같음</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">예를 들어, colorize 작업에서는 모델이 세그멘테이션과 depth estimation 작업에서 얻은 이미지 구조에 대한 이해를 활용했고, 블러 제거와 인페인팅 작업에서는 <b>엣지 detect</b>및 <b>outpainting</b> 를 잘 조함해서 활용했음.</p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16">&nbsp;</p>
    </div>
    
    <div style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid rgba(255,255,255,0.1); text-align: center;">
        <a href="../../blog.html" class="back-link">← Back to Blog</a>
    </div>
</body>
</html>
